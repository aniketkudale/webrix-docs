(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"0YF5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("mrSG"),s=r("ADVu"),n=r("Xeau"),o=function(){function e(){this._dirty=!0,this._tempColor=new n.b(0,0,0,0),this._globalCurve=new n.b(0,0,0,0),this._highlightsCurve=new n.b(0,0,0,0),this._midtonesCurve=new n.b(0,0,0,0),this._shadowsCurve=new n.b(0,0,0,0),this._positiveCurve=new n.b(0,0,0,0),this._negativeCurve=new n.b(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}return Object.defineProperty(e.prototype,"globalHue",{get:function(){return this._globalHue},set:function(e){this._globalHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalDensity",{get:function(){return this._globalDensity},set:function(e){this._globalDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalSaturation",{get:function(){return this._globalSaturation},set:function(e){this._globalSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalExposure",{get:function(){return this._globalExposure},set:function(e){this._globalExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsHue",{get:function(){return this._highlightsHue},set:function(e){this._highlightsHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsDensity",{get:function(){return this._highlightsDensity},set:function(e){this._highlightsDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsSaturation",{get:function(){return this._highlightsSaturation},set:function(e){this._highlightsSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsExposure",{get:function(){return this._highlightsExposure},set:function(e){this._highlightsExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesHue",{get:function(){return this._midtonesHue},set:function(e){this._midtonesHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesDensity",{get:function(){return this._midtonesDensity},set:function(e){this._midtonesDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesSaturation",{get:function(){return this._midtonesSaturation},set:function(e){this._midtonesSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesExposure",{get:function(){return this._midtonesExposure},set:function(e){this._midtonesExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsHue",{get:function(){return this._shadowsHue},set:function(e){this._shadowsHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsDensity",{get:function(){return this._shadowsDensity},set:function(e){this._shadowsDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsSaturation",{get:function(){return this._shadowsSaturation},set:function(e){this._shadowsSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsExposure",{get:function(){return this._shadowsExposure},set:function(e){this._shadowsExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"ColorCurves"},e.Bind=function(e,t,r,i,s){void 0===r&&(r="vCameraColorCurvePositive"),void 0===i&&(i="vCameraColorCurveNeutral"),void 0===s&&(s="vCameraColorCurveNegative"),e._dirty&&(e._dirty=!1,e.getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e.getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e.getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e.getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t&&(t.setFloat4(r,e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4(i,e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4(s,e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a))},e.PrepareUniforms=function(e){e.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")},e.prototype.getColorGradingDataToRef=function(t,r,i,s,n){null!=t&&(t=e.clamp(t,0,360),r=e.clamp(r,-100,100),i=e.clamp(i,-100,100),s=e.clamp(s,-100,100),r=e.applyColorGradingSliderNonlinear(r),r*=.5,s=e.applyColorGradingSliderNonlinear(s),r<0&&(r*=-1,t=(t+180)%360),e.fromHSBToRef(t,r,50+.25*s,n),n.scaleToRef(2,n),n.a=1+.01*i)},e.applyColorGradingSliderNonlinear=function(e){e/=100;var t=Math.abs(e);return t=Math.pow(t,2),e<0&&(t*=-1),t*=100},e.fromHSBToRef=function(t,r,i,s){var n=e.clamp(t,0,360),o=e.clamp(r/100,0,1),a=e.clamp(i/100,0,1);if(0===o)s.r=a,s.g=a,s.b=a;else{n/=60;var h=Math.floor(n),u=n-h,c=a*(1-o),l=a*(1-o*u),d=a*(1-o*(1-u));switch(h){case 0:s.r=a,s.g=d,s.b=c;break;case 1:s.r=l,s.g=a,s.b=c;break;case 2:s.r=c,s.g=a,s.b=d;break;case 3:s.r=c,s.g=l,s.b=a;break;case 4:s.r=d,s.g=c,s.b=a;break;default:s.r=a,s.g=c,s.b=l}}s.a=1},e.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},e.prototype.clone=function(){return s.a.Clone((function(){return new e}),this)},e.prototype.serialize=function(){return s.a.Serialize(this)},e.Parse=function(t){return s.a.Parse((function(){return new e}),t,null,null)},Object(i.b)([Object(s.c)()],e.prototype,"_globalHue",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_globalDensity",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_globalSaturation",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_globalExposure",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_highlightsHue",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_highlightsDensity",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_highlightsSaturation",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_highlightsExposure",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_midtonesHue",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_midtonesDensity",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_midtonesSaturation",void 0),Object(i.b)([Object(s.c)()],e.prototype,"_midtonesExposure",void 0),e}();s.a._ColorCurvesParser=o.Parse},"9DX3":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(){}},aCSs:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var i=r("mrSG"),s=r("ADVu"),n=r("ps+7"),o=r("/SR9"),a=r("e2Mr"),h=r("FQ8M"),u=r("/sJ5"),c=(r("TFEU"),function(){function e(t){this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this.getAlphaFromRGB=!1,this.level=1,this.coordinatesIndex=0,this._coordinatesMode=0,this.wrapU=1,this.wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=e.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this.gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this.animations=new Array,this.onDisposeObservable=new n.a,this._onDisposeObserver=null,this.delayLoadState=0,this._scene=null,this._texture=null,this._uid=null,this._cachedSize=u.a.Zero(),this._scene=t||a.a.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this)),this._uid=null}return Object.defineProperty(e.prototype,"hasAlpha",{get:function(){return this._hasAlpha},set:function(e){this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(17))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinatesMode",{get:function(){return this._coordinatesMode},set:function(e){this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRGBD",{get:function(){return null!=this._texture&&this._texture._isRGBD},set:function(e){this._texture&&(this._texture._isRGBD=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noMipmap",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lodGenerationOffset",{get:function(){return this._texture?this._texture._lodGenerationOffset:0},set:function(e){this._texture&&(this._texture._lodGenerationOffset=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lodGenerationScale",{get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(e){this._texture&&(this._texture._lodGenerationScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linearSpecularLOD",{get:function(){return!!this._texture&&this._texture._linearSpecularLOD},set:function(e){this._texture&&(this._texture._linearSpecularLOD=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"irradianceTexture",{get:function(){return this._texture?this._texture._irradianceTexture:null},set:function(e){this._texture&&(this._texture._irradianceTexture=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid||(this._uid=h.a.RandomId()),this._uid},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.name},e.prototype.getClassName=function(){return"BaseTexture"},Object.defineProperty(e.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBlocking",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getScene=function(){return this._scene},e.prototype.getTextureMatrix=function(){return o.a.IdentityReadOnly},e.prototype.getReflectionTextureMatrix=function(){return o.a.IdentityReadOnly},e.prototype.getInternalTexture=function(){return this._texture},e.prototype.isReadyOrNotBlocking=function(){return!this.isBlocking||this.isReady()},e.prototype.isReady=function(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},e.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},e.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?new u.a(this._texture._size,this._texture._size):new u.a(this._texture.baseWidth,this._texture.baseHeight):u.a.Zero()},e.prototype.updateSamplingMode=function(e){if(this._texture){var t=this.getScene();t&&t.getEngine().updateTextureSamplingMode(e,this._texture)}},e.prototype.scale=function(e){},Object.defineProperty(e.prototype,"canRescale",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype._getFromCache=function(e,t,r,i){if(!this._scene)return null;for(var s=this._scene.getEngine().getLoadedTexturesCache(),n=0;n<s.length;n++){var o=s[n];if(!(void 0!==i&&i!==o.invertY||o.url!==e||o.generateMipMaps!==!t||r&&r!==o.samplingMode))return o.incrementReferences(),o}return null},e.prototype._rebuild=function(){},e.prototype.delayLoad=function(){},e.prototype.clone=function(){return null},Object.defineProperty(e.prototype,"textureType",{get:function(){return this._texture&&void 0!==this._texture.type?this._texture.type:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFormat",{get:function(){return this._texture&&void 0!==this._texture.format?this._texture.format:5},enumerable:!0,configurable:!0}),e.prototype._markAllSubMeshesAsTexturesDirty=function(){var e=this.getScene();e&&e.markAllMaterialsAsDirty(1)},e.prototype.readPixels=function(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=null),!this._texture)return null;var i=this.getSize(),s=i.width,n=i.height,o=this.getScene();if(!o)return null;var a=o.getEngine();return 0!=t&&(s/=Math.pow(2,t),n/=Math.pow(2,t),s=Math.round(s),n=Math.round(n)),this._texture.isCube?a._readTexturePixels(this._texture,s,n,e,t,r):a._readTexturePixels(this._texture,s,n,-1,t,r)},e.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},Object.defineProperty(e.prototype,"_lodTextureHigh",{get:function(){return this._texture?this._texture._lodTextureHigh:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_lodTextureMid",{get:function(){return this._texture?this._texture._lodTextureMid:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_lodTextureLow",{get:function(){return this._texture?this._texture._lodTextureLow:null},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene._removePendingData(this);var e=this._scene.textures.indexOf(this);e>=0&&this._scene.textures.splice(e,1),this._scene.onTextureRemovedObservable.notifyObservers(this)}void 0!==this._texture&&(this.releaseInternalTexture(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear())},e.prototype.serialize=function(){if(!this.name)return null;var e=s.a.Serialize(this);return s.a.AppendSerializedAnimations(this,e),e},e.WhenAllReady=function(e,t){var r=e.length;if(0!==r)for(var i,s,n=function(){if((i=e[o]).isReady())0==--r&&t();else if(s=i.onLoadObservable){var n=function(){s.removeCallback(n),0==--r&&t()};s.add(n)}},o=0;o<e.length;o++)n();else t()},e.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,Object(i.b)([Object(s.c)()],e.prototype,"uniqueId",void 0),Object(i.b)([Object(s.c)()],e.prototype,"name",void 0),Object(i.b)([Object(s.c)()],e.prototype,"metadata",void 0),Object(i.b)([Object(s.c)("hasAlpha")],e.prototype,"_hasAlpha",void 0),Object(i.b)([Object(s.c)()],e.prototype,"getAlphaFromRGB",void 0),Object(i.b)([Object(s.c)()],e.prototype,"level",void 0),Object(i.b)([Object(s.c)()],e.prototype,"coordinatesIndex",void 0),Object(i.b)([Object(s.c)("coordinatesMode")],e.prototype,"_coordinatesMode",void 0),Object(i.b)([Object(s.c)()],e.prototype,"wrapU",void 0),Object(i.b)([Object(s.c)()],e.prototype,"wrapV",void 0),Object(i.b)([Object(s.c)()],e.prototype,"wrapR",void 0),Object(i.b)([Object(s.c)()],e.prototype,"anisotropicFilteringLevel",void 0),Object(i.b)([Object(s.c)()],e.prototype,"isCube",null),Object(i.b)([Object(s.c)()],e.prototype,"is3D",null),Object(i.b)([Object(s.c)()],e.prototype,"is2DArray",null),Object(i.b)([Object(s.c)(),Object(s.b)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"gammaSpace",void 0),Object(i.b)([Object(s.c)()],e.prototype,"invertZ",void 0),Object(i.b)([Object(s.c)()],e.prototype,"lodLevelInAlpha",void 0),Object(i.b)([Object(s.c)()],e.prototype,"lodGenerationOffset",null),Object(i.b)([Object(s.c)()],e.prototype,"lodGenerationScale",null),Object(i.b)([Object(s.c)()],e.prototype,"linearSpecularLOD",null),Object(i.b)([Object(s.k)()],e.prototype,"irradianceTexture",null),Object(i.b)([Object(s.c)()],e.prototype,"isRenderTarget",void 0),e}()),l=r("WHS4"),d=r("n5HA"),_=r("vYHP"),p=r("4HJg"),f=r("j2cH"),g=r("X2Ve"),b=function(e){function t(r,i,s,o,a,h,u,c,l,d,p){void 0===s&&(s=!1),void 0===o&&(o=!0),void 0===a&&(a=t.TRILINEAR_SAMPLINGMODE),void 0===h&&(h=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===l&&(l=!1);var f=e.call(this,i&&"Scene"===i.getClassName()?i:null)||this;f.url=null,f.uOffset=0,f.vOffset=0,f.uScale=1,f.vScale=1,f.uAng=0,f.vAng=0,f.wAng=0,f.uRotationCenter=.5,f.vRotationCenter=.5,f.wRotationCenter=.5,f.inspectableCustomProperties=null,f._noMipmap=!1,f._invertY=!1,f._rowGenerationMatrix=null,f._cachedTextureMatrix=null,f._projectionModeMatrix=null,f._t0=null,f._t1=null,f._t2=null,f._cachedUOffset=-1,f._cachedVOffset=-1,f._cachedUScale=0,f._cachedVScale=0,f._cachedUAng=-1,f._cachedVAng=-1,f._cachedWAng=-1,f._cachedProjectionMatrixId=-1,f._cachedCoordinatesMode=-1,f._initialSamplingMode=t.BILINEAR_SAMPLINGMODE,f._buffer=null,f._deleteBuffer=!1,f._format=null,f._delayedOnLoad=null,f._delayedOnError=null,f.onLoadObservable=new n.a,f._isBlocking=!0,f.name=r||"",f.url=r,f._noMipmap=s,f._invertY=o,f._initialSamplingMode=a,f._buffer=c,f._deleteBuffer=l,f._mimeType=p,d&&(f._format=d);var g=f.getScene(),b=i&&i.getCaps?i:g?g.getEngine():null;if(!b)return f;b.onBeforeTextureInitObservable.notifyObservers(f);var v=function(){f._texture&&(f._texture._invertVScale&&(f.vScale*=-1,f.vOffset+=1),null!==f._texture._cachedWrapU&&(f.wrapU=f._texture._cachedWrapU,f._texture._cachedWrapU=null),null!==f._texture._cachedWrapV&&(f.wrapV=f._texture._cachedWrapV,f._texture._cachedWrapV=null),null!==f._texture._cachedWrapR&&(f.wrapR=f._texture._cachedWrapR,f._texture._cachedWrapR=null)),f.onLoadObservable.hasObservers()&&f.onLoadObservable.notifyObservers(f),h&&h(),!f.isBlocking&&g&&g.resetCachedMaterial()};return f.url?(f._texture=f._getFromCache(f.url,s,a,o),f._texture?f._texture.isReady?_.a.SetImmediate((function(){return v()})):f._texture.onLoadedObservable.add(v):g&&g.useDelayedTextureLoading?(f.delayLoadState=4,f._delayedOnLoad=v,f._delayedOnError=u):(f._texture=b.createTexture(f.url,s,o,g,a,v,u,f._buffer,void 0,f._format,null,p),l&&delete f._buffer),f):(f._delayedOnLoad=v,f._delayedOnError=u,f)}return Object(i.c)(t,e),Object.defineProperty(t.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(e){this._isBlocking=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invertY",{get:function(){return this._invertY},enumerable:!0,configurable:!0}),t.prototype.updateURL=function(e,t,r){void 0===t&&(t=null),this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1)),this.name&&!g.a.StartsWith(this.name,"data:")||(this.name=e),this.url=e,this._buffer=t,this.delayLoadState=4,r&&(this._delayedOnLoad=r),this.delayLoad()},t.prototype.delayLoad=function(){if(4===this.delayLoadState){var e=this.getScene();e&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY),this._texture?this._delayedOnLoad&&(this._texture.isReady?_.a.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,null,this._mimeType),this._deleteBuffer&&delete this._buffer),this._delayedOnLoad=null,this._delayedOnError=null)}},t.prototype._prepareRowForTextureGeneration=function(e,t,r,i){e*=this._cachedUScale,t*=this._cachedVScale,e-=this.uRotationCenter*this._cachedUScale,t-=this.vRotationCenter*this._cachedVScale,r-=this.wRotationCenter,o.e.TransformCoordinatesFromFloatsToRef(e,t,r,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter},t.prototype.getTextureMatrix=function(e){var t=this;if(void 0===e&&(e=1),this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*e===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*e,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedTextureMatrix||(this._cachedTextureMatrix=o.a.Zero(),this._rowGenerationMatrix=new o.a,this._t0=o.e.Zero(),this._t1=o.e.Zero(),this._t2=o.e.Zero()),o.a.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),o.a.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix);var r=this.getScene();return r?(r.markAllMaterialsAsDirty(1,(function(e){return e.hasTexture(t)})),this._cachedTextureMatrix):this._cachedTextureMatrix},t.prototype.getReflectionTextureMatrix=function(){var e=this,r=this.getScene();if(!r)return this._cachedTextureMatrix;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode){if(this.coordinatesMode!==t.PROJECTION_MODE)return this._cachedTextureMatrix;if(this._cachedProjectionMatrixId===r.getProjectionMatrix().updateFlag)return this._cachedTextureMatrix}switch(this._cachedTextureMatrix||(this._cachedTextureMatrix=o.a.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=o.a.Zero()),this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case t.PLANAR_MODE:o.a.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix[0]=this.uScale,this._cachedTextureMatrix[5]=this.vScale,this._cachedTextureMatrix[12]=this.uOffset,this._cachedTextureMatrix[13]=this.vOffset;break;case t.PROJECTION_MODE:o.a.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var i=r.getProjectionMatrix();this._cachedProjectionMatrixId=i.updateFlag,i.multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:o.a.IdentityToRef(this._cachedTextureMatrix)}return r.markAllMaterialsAsDirty(1,(function(t){return-1!==t.getActiveTextures().indexOf(e)})),this._cachedTextureMatrix},t.prototype.clone=function(){var e=this;return s.a.Clone((function(){return new t(e._texture?e._texture.url:null,e.getScene(),e._noMipmap,e._invertY,e.samplingMode,void 0,void 0,e._texture?e._texture._buffer:void 0)}),this)},t.prototype.serialize=function(){var r=this.name;t.SerializeBuffers||g.a.StartsWith(this.name,"data:")&&(this.name="");var i=e.prototype.serialize.call(this);return i?(t.SerializeBuffers&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(i.base64String=this._buffer,i.name=i.name.replace("data:","")):this.url&&g.a.StartsWith(this.url,"data:")&&this._buffer instanceof Uint8Array&&(i.base64String="data:image/png;base64,"+g.a.EncodeArrayBufferToBase64(this._buffer))),i.invertY=this._invertY,i.samplingMode=this.samplingMode,this.name=r,i):null},t.prototype.getClassName=function(){return"Texture"},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null},t.Parse=function(e,r,i){if(e.customType){var n=p.a.Instantiate(e.customType).Parse(e,r,i);return e.samplingMode&&n.updateSamplingMode&&n._samplingMode&&n._samplingMode!==e.samplingMode&&n.updateSamplingMode(e.samplingMode),n}if(e.isCube&&!e.isRenderTarget)return t._CubeTextureParser(e,r,i);if(!e.name&&!e.isRenderTarget)return null;var o=s.a.Parse((function(){var s,n=!0;if(e.noMipmap&&(n=!1),e.mirrorPlane){var o=t._CreateMirror(e.name,e.renderTargetSize,r,n);return o._waitingRenderList=e.renderList,o.mirrorPlane=f.a.FromArray(e.mirrorPlane),o}if(e.isRenderTarget){var a=null;if(e.isCube){if(r.reflectionProbes)for(var h=0;h<r.reflectionProbes.length;h++){var u=r.reflectionProbes[h];if(u.name===e.name)return u.cubeTexture}}else(a=t._CreateRenderTargetTexture(e.name,e.renderTargetSize,r,n))._waitingRenderList=e.renderList;return a}if(e.base64String)s=t.CreateFromBase64String(e.base64String,e.name,r,!n,e.invertY);else{var c=i+e.name;t.UseSerializedUrlIfAny&&e.url&&(c=e.url),s=new t(c,r,!n,e.invertY)}return s}),e,r);if(o&&o._texture&&(o._texture._cachedWrapU=null,o._texture._cachedWrapV=null,o._texture._cachedWrapR=null),e.samplingMode){var a=e.samplingMode;o&&o.samplingMode!==a&&o.updateSamplingMode(a)}if(o&&e.animations)for(var h=0;h<e.animations.length;h++){var u=e.animations[h],c=l.a.GetClass("BABYLON.Animation");c&&o.animations.push(c.Parse(u))}return o},t.CreateFromBase64String=function(e,r,i,s,n,o,a,h,u){return void 0===o&&(o=t.TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===h&&(h=null),void 0===u&&(u=5),new t("data:"+r,i,s,n,o,a,h,e,!1,u)},t.LoadFromDataString=function(e,r,i,s,n,o,a,h,u,c){return void 0===s&&(s=!1),void 0===n&&(n=!1),void 0===o&&(o=!0),void 0===a&&(a=t.TRILINEAR_SAMPLINGMODE),void 0===h&&(h=null),void 0===u&&(u=null),void 0===c&&(c=5),"data:"!==e.substr(0,5)&&(e="data:"+e),new t(e,i,n,o,a,h,u,r,s,c)},t.SerializeBuffers=!0,t._CubeTextureParser=function(e,t,r){throw d.a.WarnImport("CubeTexture")},t._CreateMirror=function(e,t,r,i){throw d.a.WarnImport("MirrorTexture")},t._CreateRenderTargetTexture=function(e,t,r,i){throw d.a.WarnImport("RenderTargetTexture")},t.NEAREST_SAMPLINGMODE=1,t.NEAREST_NEAREST_MIPLINEAR=8,t.BILINEAR_SAMPLINGMODE=2,t.LINEAR_LINEAR_MIPNEAREST=11,t.TRILINEAR_SAMPLINGMODE=3,t.LINEAR_LINEAR_MIPLINEAR=3,t.NEAREST_NEAREST_MIPNEAREST=4,t.NEAREST_LINEAR_MIPNEAREST=5,t.NEAREST_LINEAR_MIPLINEAR=6,t.NEAREST_LINEAR=7,t.NEAREST_NEAREST=1,t.LINEAR_NEAREST_MIPNEAREST=9,t.LINEAR_NEAREST_MIPLINEAR=10,t.LINEAR_LINEAR=2,t.LINEAR_NEAREST=12,t.EXPLICIT_MODE=0,t.SPHERICAL_MODE=1,t.PLANAR_MODE=2,t.CUBIC_MODE=3,t.PROJECTION_MODE=4,t.SKYBOX_MODE=5,t.INVCUBIC_MODE=6,t.EQUIRECTANGULAR_MODE=7,t.FIXED_EQUIRECTANGULAR_MODE=8,t.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,t.CLAMP_ADDRESSMODE=0,t.WRAP_ADDRESSMODE=1,t.MIRROR_ADDRESSMODE=2,t.UseSerializedUrlIfAny=!1,Object(i.b)([Object(s.c)()],t.prototype,"url",void 0),Object(i.b)([Object(s.c)()],t.prototype,"uOffset",void 0),Object(i.b)([Object(s.c)()],t.prototype,"vOffset",void 0),Object(i.b)([Object(s.c)()],t.prototype,"uScale",void 0),Object(i.b)([Object(s.c)()],t.prototype,"vScale",void 0),Object(i.b)([Object(s.c)()],t.prototype,"uAng",void 0),Object(i.b)([Object(s.c)()],t.prototype,"vAng",void 0),Object(i.b)([Object(s.c)()],t.prototype,"wAng",void 0),Object(i.b)([Object(s.c)()],t.prototype,"uRotationCenter",void 0),Object(i.b)([Object(s.c)()],t.prototype,"vRotationCenter",void 0),Object(i.b)([Object(s.c)()],t.prototype,"wRotationCenter",void 0),Object(i.b)([Object(s.c)()],t.prototype,"isBlocking",null),t}(c);s.a._TextureParser=b.Parse},k2R8:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var i,s=r("ps+7"),n=r("9DX3"),o=r("n5HA");!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.Depth=12]="Depth",e[e.CubeRawRGBD=13]="CubeRawRGBD"}(i||(i={}));var a=function(){function e(e,t,r){void 0===r&&(r=!1),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.samplingMode=-1,this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new s.a,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=i.Unknown,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._MSAARenderBuffer=null,this._attachments=null,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._isDisabled=!1,this._compression=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._comparisonFunction=0,this._sphericalPolynomial=null,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._webGLTexture=null,this._references=1,this._engine=e,this._source=t,r||(this._webGLTexture=e._createTexture())}return e.prototype.getEngine=function(){return this._engine},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.incrementReferences=function(){this._references++},e.prototype.updateSize=function(e,t,r){void 0===r&&(r=1),this.width=e,this.height=t,this.depth=r,this.baseWidth=e,this.baseHeight=t,this.baseDepth=r,this._size=e*t*r},e.prototype._rebuild=function(){var t,r=this;switch(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedAnisotropicFilteringLevel=null,this.source){case i.Temp:return;case i.Url:return void(t=this._engine.createTexture(this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(){t._swapAndDie(r),r.isReady=!0}),null,this._buffer,void 0,this.format));case i.Raw:return(t=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case i.Raw3D:return(t=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case i.Raw2DArray:return(t=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case i.Dynamic:return(t=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this),void this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);case i.RenderTarget:var s=new n.a;if(s.generateDepthBuffer=this._generateDepthBuffer,s.generateMipMaps=this.generateMipMaps,s.generateStencilBuffer=this._generateStencilBuffer,s.samplingMode=this.samplingMode,s.type=this.type,this.isCube)t=this._engine.createRenderTargetCubeTexture(this.width,s);else{var o={width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0};t=this._engine.createRenderTargetTexture(o,s)}return t._swapAndDie(this),void(this.isReady=!0);case i.Depth:var a={bilinearFiltering:2!==this.samplingMode,comparisonFunction:this._comparisonFunction,generateStencil:this._generateStencilBuffer,isCube:this.isCube},h={width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0};return(t=this._engine.createDepthStencilTexture(h,a))._swapAndDie(this),void(this.isReady=!0);case i.Cube:return void(t=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){t._swapAndDie(r),r.isReady=!0}),null,this.format,this._extension));case i.CubeRaw:return(t=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case i.CubeRawRGBD:return t=this._engine.createRawCubeTexture(null,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),void e._UpdateRGBDAsync(t,this._bufferViewArrayArray,this._sphericalPolynomial,this._lodGenerationScale,this._lodGenerationOffset).then((function(){t._swapAndDie(r),r.isReady=!0}));case i.CubePrefiltered:return void((t=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(e){e&&e._swapAndDie(r),r.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}},e.prototype._swapAndDie=function(e){e._webGLTexture=this._webGLTexture,e._isRGBD=this._isRGBD,this._framebuffer&&(e._framebuffer=this._framebuffer),this._depthStencilBuffer&&(e._depthStencilBuffer=this._depthStencilBuffer),e._depthStencilTexture=this._depthStencilTexture,this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var t,r=this._engine.getLoadedTexturesCache();-1!==(t=r.indexOf(this))&&r.splice(t,1),-1===(t=r.indexOf(e))&&r.push(e)},e.prototype.dispose=function(){this._webGLTexture&&(this._references--,0===this._references&&(this._engine._releaseTexture(this),this._webGLTexture=null))},e._UpdateRGBDAsync=function(e,t,r,i,s){throw o.a.WarnImport("environmentTextureTools")},e}()},srWW:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r("mrSG"),s=r("ps+7"),n=r("YKqZ"),o=r("/SR9"),a=r("aCSs"),h=r("WnUc"),u=r("F24J"),c=(r("DvRB"),r("3XS9"),r("qUIE")),l=function(e){function t(t,r,i,n,h,c,l,d,_,p,f,g,b){void 0===h&&(h=!0),void 0===c&&(c=0),void 0===l&&(l=!1),void 0===d&&(d=a.a.TRILINEAR_SAMPLINGMODE),void 0===_&&(_=!0),void 0===p&&(p=!1),void 0===f&&(f=!1),void 0===g&&(g=5),void 0===b&&(b=!1);var v=e.call(this,null,i,!n)||this;return v.isCube=l,v.renderParticles=!0,v.renderSprites=!1,v.coordinatesMode=a.a.PROJECTION_MODE,v.ignoreCameraViewport=!1,v.onBeforeBindObservable=new s.a,v.onAfterUnbindObservable=new s.a,v.onBeforeRenderObservable=new s.a,v.onAfterRenderObservable=new s.a,v.onClearObservable=new s.a,v.onResizeObservable=new s.a,v._currentRefreshId=-1,v._refreshRate=1,v._samples=1,v.boundingBoxPosition=o.e.Zero(),(i=v.getScene())?(v.renderList=new Array,v._engine=i.getEngine(),v.name=t,v.isRenderTarget=!0,v._initialSizeParameter=r,v._processSizeParameter(r),v._resizeObserver=v.getScene().getEngine().onResizeObservable.add((function(){})),v._generateMipMaps=!!n,v._doNotChangeAspectRatio=h,v._renderingManager=new u.a(i),v._renderingManager._useSceneAutoClearSetup=!0,f||(v._renderTargetOptions={generateMipMaps:n,type:c,format:g,samplingMode:d,generateDepthBuffer:_,generateStencilBuffer:p},d===a.a.NEAREST_SAMPLINGMODE&&(v.wrapU=a.a.CLAMP_ADDRESSMODE,v.wrapV=a.a.CLAMP_ADDRESSMODE),b||(l?(v._texture=i.getEngine().createRenderTargetCubeTexture(v.getRenderSize(),v._renderTargetOptions),v.coordinatesMode=a.a.INVCUBIC_MODE,v._textureMatrix=o.a.Identity()):v._texture=i.getEngine().createRenderTargetTexture(v._size,v._renderTargetOptions))),v):v}return Object(i.c)(t,e),Object.defineProperty(t.prototype,"renderList",{get:function(){return this._renderList},set:function(e){this._renderList=e,this._renderList&&this._hookArray(this._renderList)},enumerable:!0,configurable:!0}),t.prototype._hookArray=function(e){var t=this,r=e.push;e.push=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var n=0===e.length,o=r.apply(e,i);return n&&t.getScene().meshes.forEach((function(e){e._markSubMeshesAsLightDirty()})),o};var i=e.splice;e.splice=function(r,s){var n=i.apply(e,[r,s]);return 0===e.length&&t.getScene().meshes.forEach((function(e){e._markSubMeshesAsLightDirty()})),n}},Object.defineProperty(t.prototype,"onAfterUnbind",{set:function(e){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onClear",{set:function(e){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderTargetOptions",{get:function(){return this._renderTargetOptions},enumerable:!0,configurable:!0}),t.prototype._onRatioRescale=function(){this._sizeRatio&&this.resize(this._initialSizeParameter)},Object.defineProperty(t.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},set:function(e){if(!this._boundingBoxSize||!this._boundingBoxSize.equals(e)){this._boundingBoxSize=e;var t=this.getScene();t&&t.markAllMaterialsAsDirty(1)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthStencilTexture",{get:function(){var e;return(null===(e=this.getInternalTexture())||void 0===e?void 0:e._depthStencilTexture)||null},enumerable:!0,configurable:!0}),t.prototype.createDepthStencilTexture=function(e,t,r){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===r&&(r=!1);var i=this.getInternalTexture();if(this.getScene()&&i){var s=this.getScene().getEngine();i._depthStencilTexture=s.createDepthStencilTexture(this._size,{bilinearFiltering:t,comparisonFunction:e,generateStencil:r,isCube:this.isCube})}},t.prototype._processSizeParameter=function(e){e.ratio?(this._sizeRatio=e.ratio,this._size={width:this._bestReflectionRenderTargetDimension(this._engine.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(this._engine.getRenderHeight(),this._sizeRatio)}):this._size=e},Object.defineProperty(t.prototype,"samples",{get:function(){return this._samples},set:function(e){if(this._samples!==e){var t=this.getScene();t&&(this._samples=t.getEngine().updateRenderTargetTextureSampleCount(this._texture,e))}},enumerable:!0,configurable:!0}),t.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},Object.defineProperty(t.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!0,configurable:!0}),t.prototype.addPostProcess=function(e){if(!this._postProcessManager){var t=this.getScene();if(!t)return;this._postProcessManager=new h.a(t),this._postProcesses=new Array}this._postProcesses.push(e),this._postProcesses[0].autoClear=!1},t.prototype.clearPostProcesses=function(e){if(void 0===e&&(e=!1),this._postProcesses){if(e)for(var t=0,r=this._postProcesses;t<r.length;t++){r[t].dispose()}this._postProcesses=[]}},t.prototype.removePostProcess=function(e){if(this._postProcesses){var t=this._postProcesses.indexOf(e);-1!==t&&(this._postProcesses.splice(t,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}},t.prototype._shouldRender=function(){return-1===this._currentRefreshId||this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)},t.prototype.getRenderSize=function(){return this.getRenderWidth()},t.prototype.getRenderWidth=function(){return this._size.width?this._size.width:this._size},t.prototype.getRenderHeight=function(){return this._size.width?this._size.height:this._size},t.prototype.getRenderLayers=function(){var e=this._size.layers;return e||0},Object.defineProperty(t.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.scale=function(e){var t=Math.max(1,this.getRenderSize()*e);this.resize(t)},t.prototype.getReflectionTextureMatrix=function(){return this.isCube?this._textureMatrix:e.prototype.getReflectionTextureMatrix.call(this)},t.prototype.resize=function(e){var t=this.isCube;this.releaseInternalTexture();var r=this.getScene();r&&(this._processSizeParameter(e),this._texture=t?r.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):r.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))},t.prototype.render=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),a=this.getScene()){var r,i=a.getEngine();if(void 0!==this.useCameraPostProcesses&&(e=this.useCameraPostProcesses),this._waitingRenderList){this.renderList=[];for(var s=0;s<this._waitingRenderList.length;s++){var n=this._waitingRenderList[s],o=a.getMeshByID(n);o&&this.renderList.push(o)}delete this._waitingRenderList}if(this.renderListPredicate){var a;if(this.renderList?this.renderList.length=0:this.renderList=[],!(a=this.getScene()))return;var h=a.meshes;for(s=0;s<h.length;s++){var u=h[s];this.renderListPredicate(u)&&this.renderList.push(u)}}if(this.onBeforeBindObservable.notifyObservers(this),this.activeCamera?(r=this.activeCamera,i.setViewport(this.activeCamera.viewport,this.getRenderWidth(),this.getRenderHeight()),this.activeCamera!==a.activeCamera&&a.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(!0))):(r=a.activeCamera)&&i.setViewport(r.viewport,this.getRenderWidth(),this.getRenderHeight()),this._defaultRenderListPrepared=!1,this.is2DArray)for(var c=0;c<this.getRenderLayers();c++)this.renderToTarget(0,e,t,c,r),a.incrementRenderId(),a.resetCachedMaterial();else if(this.isCube)for(var l=0;l<6;l++)this.renderToTarget(l,e,t,void 0,r),a.incrementRenderId(),a.resetCachedMaterial();else this.renderToTarget(0,e,t,void 0,r);this.onAfterUnbindObservable.notifyObservers(this),a.activeCamera&&((a.getEngine().scenes.length>1||this.activeCamera&&this.activeCamera!==a.activeCamera)&&a.setTransformMatrix(a.activeCamera.getViewMatrix(),a.activeCamera.getProjectionMatrix(!0)),i.setViewport(a.activeCamera.viewport)),a.resetCachedMaterial()}},t.prototype._bestReflectionRenderTargetDimension=function(e,t){var r=e*t,i=c.a.NearestPOT(r+16384/(128+r));return Math.min(c.a.FloorPOT(e),i)},t.prototype._prepareRenderingManager=function(e,t,r,i){var s=this.getScene();if(s){this._renderingManager.reset();for(var n=s.getRenderId(),o=0;o<t;o++){var a=e[o];if(a){if(!a.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}a._preActivateForIntermediateRendering(n);var h=void 0;if(h=!(!i||!r)&&0==(a.layerMask&r.layerMask),a.isEnabled()&&a.isVisible&&a.subMeshes&&!h&&a._activate(n,!0)&&a.subMeshes.length){a.isAnInstance?a=a.sourceMesh:a._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,a._internalAbstractMeshDataInfo._isActiveIntermediate=!0;for(var u=0;u<a.subMeshes.length;u++){var c=a.subMeshes[u];this._renderingManager.dispatch(c,a)}}}}for(var l=0;l<s.particleSystems.length;l++){var d=s.particleSystems[l],_=d.emitter;d.isStarted()&&_&&_.position&&_.isEnabled()&&(e.indexOf(_)>=0&&this._renderingManager.dispatchParticles(d))}}},t.prototype._bindFrameBuffer=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var r=this.getScene();if(r){var i=r.getEngine();this._texture&&i.bindFramebuffer(this._texture,this.isCube?e:void 0,void 0,void 0,this.ignoreCameraViewport,0,t)}},t.prototype.unbindFrameBuffer=function(e,t){var r=this;this._texture&&e.unBindFramebuffer(this._texture,this.isCube,(function(){r.onAfterRenderObservable.notifyObservers(t)}))},t.prototype.renderToTarget=function(e,t,r,i,s){void 0===i&&(i=0),void 0===s&&(s=null);var o=this.getScene();if(o){var a=o.getEngine();if(this._texture){this._postProcessManager?this._postProcessManager._prepareFrame(this._texture,this._postProcesses):t&&o.postProcessManager._prepareFrame(this._texture)||this._bindFrameBuffer(e,i),this.is2DArray?this.onBeforeRenderObservable.notifyObservers(i):this.onBeforeRenderObservable.notifyObservers(e);var h=null,u=this.renderList?this.renderList:o.getActiveMeshes().data,c=this.renderList?this.renderList.length:o.getActiveMeshes().length;this.getCustomRenderList&&(h=this.getCustomRenderList(this.is2DArray?i:e,u,c)),h?this._prepareRenderingManager(h,h.length,s,!1):(this._defaultRenderListPrepared||(this._prepareRenderingManager(u,c,s,!this.renderList),this._defaultRenderListPrepared=!0),h=u),this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(a):a.clear(this.clearColor||o.clearColor,!0,!0,!0),this._doNotChangeAspectRatio||o.updateTransformMatrix(!0);for(var l=0,d=o._beforeRenderTargetDrawStage;l<d.length;l++){d[l].action(this)}this._renderingManager.render(this.customRenderFunction,h,this.renderParticles,this.renderSprites);for(var _=0,p=o._afterRenderTargetDrawStage;_<p.length;_++){p[_].action(this)}this._postProcessManager?this._postProcessManager._finalizeFrame(!1,this._texture,e,this._postProcesses,this.ignoreCameraViewport):t&&o.postProcessManager._finalizeFrame(!1,this._texture,e),this._doNotChangeAspectRatio||o.updateTransformMatrix(!0),r&&n.b.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),a),this.isCube&&5!==e?this.onAfterRenderObservable.notifyObservers(e):(this.isCube&&5===e&&a.generateMipMapsForCubemap(this._texture),this.unbindFrameBuffer(a,e))}}},t.prototype.setRenderingOrder=function(e,t,r,i){void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=null),this._renderingManager.setRenderingOrder(e,t,r,i)},t.prototype.setRenderingAutoClearDepthStencil=function(e,t){this._renderingManager.setRenderingAutoClearDepthStencil(e,t),this._renderingManager._useSceneAutoClearSetup=!1},t.prototype.clone=function(){var e=this.getSize(),r=new t(this.name,e,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer);return r.hasAlpha=this.hasAlpha,r.level=this.level,r.coordinatesMode=this.coordinatesMode,this.renderList&&(r.renderList=this.renderList.slice(0)),r},t.prototype.serialize=function(){if(!this.name)return null;var t=e.prototype.serialize.call(this);if(t.renderTargetSize=this.getRenderSize(),t.renderList=[],this.renderList)for(var r=0;r<this.renderList.length;r++)t.renderList.push(this.renderList[r].id);return t},t.prototype.disposeFramebufferObjects=function(){var e=this.getInternalTexture(),t=this.getScene();e&&t&&t.getEngine()._releaseFramebufferObjects(e)},t.prototype.dispose=function(){this.onResizeObservable.clear(),this.onClearObservable.clear(),this.onAfterRenderObservable.clear(),this.onAfterUnbindObservable.clear(),this.onBeforeBindObservable.clear(),this.onBeforeRenderObservable.clear(),this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;var t=this.getScene();if(t){var r=t.customRenderTargets.indexOf(this);r>=0&&t.customRenderTargets.splice(r,1);for(var i=0,s=t.cameras;i<s.length;i++){var n=s[i];(r=n.customRenderTargets.indexOf(this))>=0&&n.customRenderTargets.splice(r,1)}this.depthStencilTexture&&this.getScene().getEngine()._releaseTexture(this.depthStencilTexture),e.prototype.dispose.call(this)}},t.prototype._rebuild=function(){this.refreshRate===t.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=t.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()},t.prototype.freeRenderingGroups=function(){this._renderingManager&&this._renderingManager.freeRenderingGroups()},t.prototype.getViewCount=function(){return 1},t.REFRESHRATE_RENDER_ONCE=0,t.REFRESHRATE_RENDER_ONEVERYFRAME=1,t.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2,t}(a.a);a.a._CreateRenderTargetTexture=function(e,t,r,i){return new l(e,t,r,i)}}}]);