(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"3kgD":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("/SR9"),n=i("n5HA"),o=function(){function e(t,i){if(void 0===i&&(i=e.DefaultPluginFactory()),this._physicsPlugin=i,this._impostors=[],this._joints=[],this._subTimeStep=0,!this._physicsPlugin.isSupported())throw new Error("Physics Engine "+this._physicsPlugin.name+" cannot be found. Please make sure it is included.");t=t||new s.e(0,-9.807,0),this.setGravity(t),this.setTimeStep()}return e.DefaultPluginFactory=function(){throw n.a.WarnImport("CannonJSPlugin")},e.prototype.setGravity=function(e){this.gravity=e,this._physicsPlugin.setGravity(this.gravity)},e.prototype.setTimeStep=function(e){void 0===e&&(e=1/60),this._physicsPlugin.setTimeStep(e)},e.prototype.getTimeStep=function(){return this._physicsPlugin.getTimeStep()},e.prototype.setSubTimeStep=function(e){void 0===e&&(e=0),this._subTimeStep=e},e.prototype.getSubTimeStep=function(){return this._subTimeStep},e.prototype.dispose=function(){this._impostors.forEach((function(e){e.dispose()})),this._physicsPlugin.dispose()},e.prototype.getPhysicsPluginName=function(){return this._physicsPlugin.name},e.prototype.addImpostor=function(e){e.uniqueId=this._impostors.push(e),e.parent||this._physicsPlugin.generatePhysicsBody(e)},e.prototype.removeImpostor=function(e){var t=this._impostors.indexOf(e);t>-1&&(this._impostors.splice(t,1).length&&this.getPhysicsPlugin().removePhysicsBody(e))},e.prototype.addJoint=function(e,t,i){var s={mainImpostor:e,connectedImpostor:t,joint:i};i.physicsPlugin=this._physicsPlugin,this._joints.push(s),this._physicsPlugin.generateJoint(s)},e.prototype.removeJoint=function(e,t,i){var s=this._joints.filter((function(s){return s.connectedImpostor===t&&s.joint===i&&s.mainImpostor===e}));s.length&&this._physicsPlugin.removeJoint(s[0])},e.prototype._step=function(e){var t=this;this._impostors.forEach((function(e){e.isBodyInitRequired()&&t._physicsPlugin.generatePhysicsBody(e)})),e>.1?e=.1:e<=0&&(e=1/60),this._physicsPlugin.executeStep(e,this._impostors)},e.prototype.getPhysicsPlugin=function(){return this._physicsPlugin},e.prototype.getImpostors=function(){return this._impostors},e.prototype.getImpostorForPhysicsObject=function(e){for(var t=0;t<this._impostors.length;++t)if(this._impostors[t].object===e)return this._impostors[t];return null},e.prototype.getImpostorWithPhysicsBody=function(e){for(var t=0;t<this._impostors.length;++t)if(this._impostors[t].physicsBody===e)return this._impostors[t];return null},e.prototype.raycast=function(e,t){return this._physicsPlugin.raycast(e,t)},e.Epsilon=.001,e}()},"4gN4":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("mrSG"),n=function(){function e(e,t){this.type=e,this.jointData=t,t.nativeParams=t.nativeParams||{}}return Object.defineProperty(e.prototype,"physicsJoint",{get:function(){return this._physicsJoint},set:function(e){this._physicsJoint,this._physicsJoint=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"physicsPlugin",{set:function(e){this._physicsPlugin=e},enumerable:!0,configurable:!0}),e.prototype.executeNativeFunction=function(e){e(this._physicsPlugin.world,this._physicsJoint)},e.DistanceJoint=0,e.HingeJoint=1,e.BallAndSocketJoint=2,e.WheelJoint=3,e.SliderJoint=4,e.PrismaticJoint=5,e.UniversalJoint=6,e.Hinge2Joint=e.WheelJoint,e.PointToPointJoint=8,e.SpringJoint=9,e.LockJoint=10,e}(),o=(function(e){function t(t){return e.call(this,n.DistanceJoint,t)||this}Object(s.c)(t,e),t.prototype.updateDistance=function(e,t){this._physicsPlugin.updateDistanceJoint(this,e,t)}}(n),function(e){function t(t,i){return e.call(this,t,i)||this}return Object(s.c)(t,e),t.prototype.setMotor=function(e,t){this._physicsPlugin.setMotor(this,e||0,t)},t.prototype.setLimit=function(e,t){this._physicsPlugin.setLimit(this,e,t)},t}(n));(function(e){function t(t){return e.call(this,n.HingeJoint,t)||this}Object(s.c)(t,e),t.prototype.setMotor=function(e,t){this._physicsPlugin.setMotor(this,e||0,t)},t.prototype.setLimit=function(e,t){this._physicsPlugin.setLimit(this,e,t)}})(o),function(e){function t(t){return e.call(this,n.Hinge2Joint,t)||this}Object(s.c)(t,e),t.prototype.setMotor=function(e,t,i){void 0===i&&(i=0),this._physicsPlugin.setMotor(this,e||0,t,i)},t.prototype.setLimit=function(e,t,i){void 0===i&&(i=0),this._physicsPlugin.setLimit(this,e,t,i)}}(o)},AGTA:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("mrSG"),n=i("OJ6t"),o=i("aCSs"),r=(i("3cLf"),i("tKhU"),function(e){function t(t,i,s,n,r,a,c,h,p,u,l){void 0===a&&(a=o.a.BILINEAR_SAMPLINGMODE),void 0===p&&(p=0),void 0===u&&(u=""),void 0===l&&(l=!1);var f=e.call(this,t,"kernelBlur",["delta","direction","cameraMinMaxZ"],["circleOfConfusionSampler"],n,r,a,c,h,null,p,"kernelBlur",{varyingCount:0,depCount:0},!0)||this;return f.direction=i,f.blockCompilation=l,f._packedFloat=!1,f._staticDefines="",f._staticDefines=u,f.onApplyObservable.add((function(e){f._outputTexture?e.setFloat2("delta",1/f._outputTexture.width*f.direction.x,1/f._outputTexture.height*f.direction.y):e.setFloat2("delta",1/f.width*f.direction.x,1/f.height*f.direction.y)})),f.kernel=s,f}return Object(s.c)(t,e),Object.defineProperty(t.prototype,"kernel",{get:function(){return this._idealKernel},set:function(e){this._idealKernel!==e&&(e=Math.max(e,1),this._idealKernel=e,this._kernel=this._nearestBestKernel(e),this.blockCompilation||this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"packedFloat",{get:function(){return this._packedFloat},set:function(e){this._packedFloat!==e&&(this._packedFloat=e,this.blockCompilation||this._updateParameters())},enumerable:!0,configurable:!0}),t.prototype.updateEffect=function(e,t,i,s,n,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=null),this._updateParameters(n,o)},t.prototype._updateParameters=function(t,i){for(var s=this._kernel,n=(s-1)/2,o=[],r=[],a=0,c=0;c<s;c++){var h=c/(s-1),p=this._gaussianWeight(2*h-1);o[c]=c-n,r[c]=p,a+=p}for(c=0;c<r.length;c++)r[c]/=a;var u=[],l=[],f=[];for(c=0;c<=n;c+=2){var d=Math.min(c+1,Math.floor(n));if(c===d)f.push({o:o[c],w:r[c]});else{var g=d===n,y=r[c]+r[d]*(g?.5:1),_=o[c]+1/(1+r[c]/r[d]);0===_?(f.push({o:o[c],w:r[c]}),f.push({o:o[c+1],w:r[c+1]})):(f.push({o:_,w:y}),f.push({o:-_,w:y}))}}for(c=0;c<f.length;c++)l[c]=f[c].o,u[c]=f[c].w;o=l,r=u;var b=this.getEngine().getCaps().maxVaryingVectors,m=Math.max(b,0)-1,P=Math.min(o.length,m),v="";v+=this._staticDefines,-1!=this._staticDefines.indexOf("DOF")&&(v+="#define CENTER_WEIGHT "+this._glslFloat(r[P-1])+"\r\n",P--);for(c=0;c<P;c++)v+="#define KERNEL_OFFSET"+c+" "+this._glslFloat(o[c])+"\r\n",v+="#define KERNEL_WEIGHT"+c+" "+this._glslFloat(r[c])+"\r\n";var O=0;for(c=m;c<o.length;c++)v+="#define KERNEL_DEP_OFFSET"+O+" "+this._glslFloat(o[c])+"\r\n",v+="#define KERNEL_DEP_WEIGHT"+O+" "+this._glslFloat(r[c])+"\r\n",O++;this.packedFloat&&(v+="#define PACKEDFLOAT 1"),this.blockCompilation=!1,e.prototype.updateEffect.call(this,v,null,null,{varyingCount:P,depCount:O},t,i)},t.prototype._nearestBestKernel=function(e){for(var t=Math.round(e),i=0,s=[t,t-1,t+1,t-2,t+2];i<s.length;i++){var n=s[i];if(n%2!=0&&Math.floor(n/2)%2==0&&n>0)return Math.max(n,3)}return Math.max(t,3)},t.prototype._gaussianWeight=function(e){var t=-e*e/(1/3*2*(1/3));return 1/(Math.sqrt(2*Math.PI)*(1/3))*Math.exp(t)},t.prototype._glslFloat=function(e,t){return void 0===t&&(t=8),e.toFixed(t).replace(/0+$/,"")},t}(n.a))},Hy5V:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var s=function(){function e(){}return Object.defineProperty(e,"UniqueId",{get:function(){var e=this._UniqueIdCounter;return this._UniqueIdCounter++,e},enumerable:!0,configurable:!0}),e._UniqueIdCounter=0,e}()},Ksm9:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var s=function(){function e(){this._xhr=new XMLHttpRequest}return e.prototype._injectCustomRequestHeaders=function(){for(var t in e.CustomRequestHeaders){var i=e.CustomRequestHeaders[t];i&&this._xhr.setRequestHeader(t,i)}},Object.defineProperty(e.prototype,"onprogress",{get:function(){return this._xhr.onprogress},set:function(e){this._xhr.onprogress=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._xhr.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._xhr.status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"statusText",{get:function(){return this._xhr.statusText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this._xhr.response},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responseURL",{get:function(){return this._xhr.responseURL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responseText",{get:function(){return this._xhr.responseText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responseType",{get:function(){return this._xhr.responseType},set:function(e){this._xhr.responseType=e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t,i){this._xhr.addEventListener(e,t,i)},e.prototype.removeEventListener=function(e,t,i){this._xhr.removeEventListener(e,t,i)},e.prototype.abort=function(){this._xhr.abort()},e.prototype.send=function(t){e.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)},e.prototype.open=function(t,i){for(var s=0,n=e.CustomRequestModifiers;s<n.length;s++){(0,n[s])(this._xhr,i)}return i=(i=i.replace("file:http:","http:")).replace("file:https:","https:"),this._xhr.open(t,i,!0)},e.prototype.setRequestHeader=function(e,t){this._xhr.setRequestHeader(e,t)},e.prototype.getResponseHeader=function(e){return this._xhr.getResponseHeader(e)},e.CustomRequestHeaders={},e.CustomRequestModifiers=new Array,e}()},"LVN+":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var s=i("uyO6"),n=i("mHtN"),o=i("/SR9"),r=i("ikaq"),a=i("wAMR"),c=i("4gN4"),h=i("SYzJ");a.a._PhysicsImpostorParser=function(e,t,i){return new p(t,i.physicsImpostor,{mass:i.physicsMass,friction:i.physicsFriction,restitution:i.physicsRestitution},e)};var p=function(){function e(e,t,i,n){var r=this;void 0===i&&(i={mass:0}),this.object=e,this.type=t,this._options=i,this._scene=n,this._pluginData={},this._bodyUpdateRequired=!1,this._onBeforePhysicsStepCallbacks=new Array,this._onAfterPhysicsStepCallbacks=new Array,this._onPhysicsCollideCallbacks=[],this._deltaPosition=o.e.Zero(),this._isDisposed=!1,this.soft=!1,this.segments=0,this._tmpQuat=new o.b,this._tmpQuat2=new o.b,this.beforeStep=function(){r._physicsEngine&&(r.object.translate(r._deltaPosition,-1),r._deltaRotationConjugated&&r.object.rotationQuaternion&&r.object.rotationQuaternion.multiplyToRef(r._deltaRotationConjugated,r.object.rotationQuaternion),r.object.computeWorldMatrix(!1),r.object.parent&&r.object.rotationQuaternion?(r.getParentsRotation(),r._tmpQuat.multiplyToRef(r.object.rotationQuaternion,r._tmpQuat)):r._tmpQuat.copyFrom(r.object.rotationQuaternion||new o.b),r._options.disableBidirectionalTransformation||r.object.rotationQuaternion&&r._physicsEngine.getPhysicsPlugin().setPhysicsBodyTransformation(r,r.object.getAbsolutePosition(),r._tmpQuat),r._onBeforePhysicsStepCallbacks.forEach((function(e){e(r)})))},this.afterStep=function(){r._physicsEngine&&(r._onAfterPhysicsStepCallbacks.forEach((function(e){e(r)})),r._physicsEngine.getPhysicsPlugin().setTransformationFromPhysicsBody(r),r.object.parent&&r.object.rotationQuaternion&&(r.getParentsRotation(),r._tmpQuat.conjugateInPlace(),r._tmpQuat.multiplyToRef(r.object.rotationQuaternion,r.object.rotationQuaternion)),r.object.setAbsolutePosition(r.object.position),r._deltaRotation&&r.object.rotationQuaternion&&r.object.rotationQuaternion.multiplyToRef(r._deltaRotation,r.object.rotationQuaternion),r.object.translate(r._deltaPosition,1))},this.onCollideEvent=null,this.onCollide=function(e){if((r._onPhysicsCollideCallbacks.length||r.onCollideEvent)&&r._physicsEngine){var t=r._physicsEngine.getImpostorWithPhysicsBody(e.body);t&&(r.onCollideEvent&&r.onCollideEvent(r,t),r._onPhysicsCollideCallbacks.filter((function(e){return-1!==e.otherImpostors.indexOf(t)})).forEach((function(e){e.callback(r,t)})))}},this.object?(this.object.parent&&0!==i.mass&&s.a.Warn("A physics impostor has been created for an object which has a parent. Babylon physics currently works in local space so unexpected issues may occur."),!this._scene&&e.getScene&&(this._scene=e.getScene()),this._scene&&(this.type>100&&(this.soft=!0),this._physicsEngine=this._scene.getPhysicsEngine(),this._physicsEngine?(this.object.rotationQuaternion||(this.object.rotation?this.object.rotationQuaternion=o.b.RotationYawPitchRoll(this.object.rotation.y,this.object.rotation.x,this.object.rotation.z):this.object.rotationQuaternion=new o.b),this._options.mass=void 0===i.mass?0:i.mass,this._options.friction=void 0===i.friction?.2:i.friction,this._options.restitution=void 0===i.restitution?.2:i.restitution,this.soft&&(this._options.mass=this._options.mass>0?this._options.mass:1,this._options.pressure=void 0===i.pressure?200:i.pressure,this._options.stiffness=void 0===i.stiffness?1:i.stiffness,this._options.velocityIterations=void 0===i.velocityIterations?20:i.velocityIterations,this._options.positionIterations=void 0===i.positionIterations?20:i.positionIterations,this._options.fixedPoints=void 0===i.fixedPoints?0:i.fixedPoints,this._options.margin=void 0===i.margin?0:i.margin,this._options.damping=void 0===i.damping?0:i.damping,this._options.path=void 0===i.path?null:i.path,this._options.shape=void 0===i.shape?null:i.shape),this._joints=[],!this.object.parent||this._options.ignoreParent?this._init():this.object.parent.physicsImpostor&&s.a.Warn("You must affect impostors to children before affecting impostor to parent.")):s.a.Error("Physics not enabled. Please use scene.enablePhysics(...) before creating impostors."))):s.a.Error("No object was provided. A physics object is obligatory")}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mass",{get:function(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getBodyMass(this):0},set:function(e){this.setMass(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"friction",{get:function(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getBodyFriction(this):0},set:function(e){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setBodyFriction(this,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restitution",{get:function(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getBodyRestitution(this):0},set:function(e){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setBodyRestitution(this,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pressure",{get:function(){if(!this._physicsEngine)return 0;var e=this._physicsEngine.getPhysicsPlugin();return e.setBodyPressure?e.getBodyPressure(this):0},set:function(e){if(this._physicsEngine){var t=this._physicsEngine.getPhysicsPlugin();t.setBodyPressure&&t.setBodyPressure(this,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stiffness",{get:function(){if(!this._physicsEngine)return 0;var e=this._physicsEngine.getPhysicsPlugin();return e.getBodyStiffness?e.getBodyStiffness(this):0},set:function(e){if(this._physicsEngine){var t=this._physicsEngine.getPhysicsPlugin();t.setBodyStiffness&&t.setBodyStiffness(this,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"velocityIterations",{get:function(){if(!this._physicsEngine)return 0;var e=this._physicsEngine.getPhysicsPlugin();return e.getBodyVelocityIterations?e.getBodyVelocityIterations(this):0},set:function(e){if(this._physicsEngine){var t=this._physicsEngine.getPhysicsPlugin();t.setBodyVelocityIterations&&t.setBodyVelocityIterations(this,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positionIterations",{get:function(){if(!this._physicsEngine)return 0;var e=this._physicsEngine.getPhysicsPlugin();return e.getBodyPositionIterations?e.getBodyPositionIterations(this):0},set:function(e){if(this._physicsEngine){var t=this._physicsEngine.getPhysicsPlugin();t.setBodyPositionIterations&&t.setBodyPositionIterations(this,e)}},enumerable:!0,configurable:!0}),e.prototype._init=function(){this._physicsEngine&&(this._physicsEngine.removeImpostor(this),this.physicsBody=null,this._parent=this._parent||this._getPhysicsParent(),this._isDisposed||this.parent&&!this._options.ignoreParent||this._physicsEngine.addImpostor(this))},e.prototype._getPhysicsParent=function(){return this.object.parent instanceof r.a?this.object.parent.physicsImpostor:null},e.prototype.isBodyInitRequired=function(){return this._bodyUpdateRequired||!this._physicsBody&&!this._parent},e.prototype.setScalingUpdated=function(){this.forceUpdate()},e.prototype.forceUpdate=function(){this._init(),this.parent&&!this._options.ignoreParent&&this.parent.forceUpdate()},Object.defineProperty(e.prototype,"physicsBody",{get:function(){return this._parent&&!this._options.ignoreParent?this._parent.physicsBody:this._physicsBody},set:function(e){this._physicsBody&&this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().removePhysicsBody(this),this._physicsBody=e,this.resetUpdateFlags()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return!this._options.ignoreParent&&this._parent?this._parent:null},set:function(e){this._parent=e},enumerable:!0,configurable:!0}),e.prototype.resetUpdateFlags=function(){this._bodyUpdateRequired=!1},e.prototype.getObjectExtendSize=function(){if(this.object.getBoundingInfo){var t=this.object.rotationQuaternion;this.object.rotationQuaternion=e.IDENTITY_QUATERNION,this.object.computeWorldMatrix&&this.object.computeWorldMatrix(!0);var i=this.object.getBoundingInfo().boundingBox.extendSizeWorld.scale(2);return this.object.rotationQuaternion=t,this.object.computeWorldMatrix&&this.object.computeWorldMatrix(!0),i}return e.DEFAULT_OBJECT_SIZE},e.prototype.getObjectCenter=function(){return this.object.getBoundingInfo?this.object.getBoundingInfo().boundingBox.centerWorld:this.object.position},e.prototype.getParam=function(e){return this._options[e]},e.prototype.setParam=function(e,t){this._options[e]=t,this._bodyUpdateRequired=!0},e.prototype.setMass=function(e){this.getParam("mass")!==e&&this.setParam("mass",e),this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setBodyMass(this,e)},e.prototype.getLinearVelocity=function(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getLinearVelocity(this):o.e.Zero()},e.prototype.setLinearVelocity=function(e){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setLinearVelocity(this,e)},e.prototype.getAngularVelocity=function(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getAngularVelocity(this):o.e.Zero()},e.prototype.setAngularVelocity=function(e){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setAngularVelocity(this,e)},e.prototype.executeNativeFunction=function(e){this._physicsEngine&&e(this._physicsEngine.getPhysicsPlugin().world,this.physicsBody)},e.prototype.registerBeforePhysicsStep=function(e){this._onBeforePhysicsStepCallbacks.push(e)},e.prototype.unregisterBeforePhysicsStep=function(e){var t=this._onBeforePhysicsStepCallbacks.indexOf(e);t>-1?this._onBeforePhysicsStepCallbacks.splice(t,1):s.a.Warn("Function to remove was not found")},e.prototype.registerAfterPhysicsStep=function(e){this._onAfterPhysicsStepCallbacks.push(e)},e.prototype.unregisterAfterPhysicsStep=function(e){var t=this._onAfterPhysicsStepCallbacks.indexOf(e);t>-1?this._onAfterPhysicsStepCallbacks.splice(t,1):s.a.Warn("Function to remove was not found")},e.prototype.registerOnPhysicsCollide=function(e,t){var i=e instanceof Array?e:[e];this._onPhysicsCollideCallbacks.push({callback:t,otherImpostors:i})},e.prototype.unregisterOnPhysicsCollide=function(e,t){var i=e instanceof Array?e:[e],n=-1;this._onPhysicsCollideCallbacks.some((function(e,s){if(e.callback===t&&e.otherImpostors.length===i.length){var o=e.otherImpostors.every((function(e){return i.indexOf(e)>-1}));return o&&(n=s),o}return!1}))?this._onPhysicsCollideCallbacks.splice(n,1):s.a.Warn("Function to remove was not found")},e.prototype.getParentsRotation=function(){var e=this.object.parent;for(this._tmpQuat.copyFromFloats(0,0,0,1);e;)e.rotationQuaternion?this._tmpQuat2.copyFrom(e.rotationQuaternion):o.b.RotationYawPitchRollToRef(e.rotation.y,e.rotation.x,e.rotation.z,this._tmpQuat2),this._tmpQuat.multiplyToRef(this._tmpQuat2,this._tmpQuat),e=e.parent;return this._tmpQuat},e.prototype.applyForce=function(e,t){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().applyForce(this,e,t),this},e.prototype.applyImpulse=function(e,t){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().applyImpulse(this,e,t),this},e.prototype.createJoint=function(e,t,i){var s=new c.a(t,i);return this.addJoint(e,s),this},e.prototype.addJoint=function(e,t){return this._joints.push({otherImpostor:e,joint:t}),this._physicsEngine&&this._physicsEngine.addJoint(this,e,t),this},e.prototype.addAnchor=function(e,t,i,s,n){if(!this._physicsEngine)return this;var o=this._physicsEngine.getPhysicsPlugin();return o.appendAnchor?(this._physicsEngine&&o.appendAnchor(this,e,t,i,s,n),this):this},e.prototype.addHook=function(e,t,i,s){if(!this._physicsEngine)return this;var n=this._physicsEngine.getPhysicsPlugin();return n.appendAnchor?(this._physicsEngine&&n.appendHook(this,e,t,i,s),this):this},e.prototype.sleep=function(){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().sleepBody(this),this},e.prototype.wakeUp=function(){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().wakeUpBody(this),this},e.prototype.clone=function(t){return t?new e(t,this.type,this._options,this._scene):null},e.prototype.dispose=function(){var e=this;this._physicsEngine&&(this._joints.forEach((function(t){e._physicsEngine&&e._physicsEngine.removeJoint(e,t.otherImpostor,t.joint)})),this._physicsEngine.removeImpostor(this),this.parent&&this.parent.forceUpdate(),this._isDisposed=!0)},e.prototype.setDeltaPosition=function(e){this._deltaPosition.copyFrom(e)},e.prototype.setDeltaRotation=function(e){this._deltaRotation||(this._deltaRotation=new o.b),this._deltaRotation.copyFrom(e),this._deltaRotationConjugated=this._deltaRotation.conjugate()},e.prototype.getBoxSizeToRef=function(e){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().getBoxSizeToRef(this,e),this},e.prototype.getRadius=function(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getRadius(this):0},e.prototype.syncBoneWithImpostor=function(t,i,s,n,o){var r=e._tmpVecs[0],a=this.object;if(a.rotationQuaternion)if(o){var c=e._tmpQuat;a.rotationQuaternion.multiplyToRef(o,c),t.setRotationQuaternion(c,h.b.WORLD,i)}else t.setRotationQuaternion(a.rotationQuaternion,h.b.WORLD,i);r.x=0,r.y=0,r.z=0,s&&(r.x=s.x,r.y=s.y,r.z=s.z,t.getDirectionToRef(r,i,r),null==n&&(n=s.length()),r.x*=n,r.y*=n,r.z*=n),t.getParent()?(r.addInPlace(a.getAbsolutePosition()),t.setAbsolutePosition(r,i)):(i.setAbsolutePosition(a.getAbsolutePosition()),i.position.x-=r.x,i.position.y-=r.y,i.position.z-=r.z)},e.prototype.syncImpostorWithBone=function(t,i,s,n,o,r){var a=this.object;if(a.rotationQuaternion)if(o){var c=e._tmpQuat;t.getRotationQuaternionToRef(h.b.WORLD,i,c),c.multiplyToRef(o,a.rotationQuaternion)}else t.getRotationQuaternionToRef(h.b.WORLD,i,a.rotationQuaternion);var p=e._tmpVecs[0],u=e._tmpVecs[1];r||((r=e._tmpVecs[2]).x=0,r.y=1,r.z=0),t.getDirectionToRef(r,i,u),t.getAbsolutePositionToRef(i,p),null==n&&s&&(n=s.length()),null!=n&&(p.x+=u.x*n,p.y+=u.y*n,p.z+=u.z*n),a.setAbsolutePosition(p)},e.DEFAULT_OBJECT_SIZE=new o.e(1,1,1),e.IDENTITY_QUATERNION=o.b.Identity(),e._tmpVecs=n.a.BuildArray(3,o.e.Zero),e._tmpQuat=o.b.Identity(),e.NoImpostor=0,e.SphereImpostor=1,e.BoxImpostor=2,e.PlaneImpostor=3,e.MeshImpostor=4,e.CapsuleImpostor=6,e.CylinderImpostor=7,e.ParticleImpostor=8,e.HeightmapImpostor=9,e.ConvexHullImpostor=10,e.CustomImpostor=100,e.RopeImpostor=101,e.ClothImpostor=102,e.SoftbodyImpostor=103,e}()},OJ6t:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i("Bfey"),n=i("ps+7"),o=i("/SR9"),r=(i("+stD"),i("qUIE")),a=(i("DvRB"),function(){function e(e,t,i,r,a,c,h,p,u,l,f,d,g,y,_){void 0===h&&(h=1),void 0===l&&(l=null),void 0===f&&(f=0),void 0===d&&(d="postprocess"),void 0===y&&(y=!1),void 0===_&&(_=5),this.name=e,this.width=-1,this.height=-1,this._outputTexture=null,this.autoClear=!0,this.alphaMode=0,this.animations=new Array,this.enablePixelPerfectMode=!1,this.forceFullscreenViewport=!0,this.scaleMode=1,this.alwaysForcePOT=!1,this._samples=1,this.adaptScaleToCurrentViewport=!1,this._reusable=!1,this._textures=new s.a(2),this._currentRenderTextureInd=0,this._scaleRatio=new o.d(1,1),this._texelSize=o.d.Zero(),this.onActivateObservable=new n.a,this.onSizeChangedObservable=new n.a,this.onApplyObservable=new n.a,this.onBeforeRenderObservable=new n.a,this.onAfterRenderObservable=new n.a,null!=c?(this._camera=c,this._scene=c.getScene(),c.attachPostProcess(this),this._engine=this._scene.getEngine(),this._scene.postProcesses.push(this),this.uniqueId=this._scene.getUniqueId()):p&&(this._engine=p,this._engine.postProcesses.push(this)),this._options=a,this.renderTargetSamplingMode=h||1,this._reusable=u||!1,this._textureType=f,this._textureFormat=_,this._samplers=r||[],this._samplers.push("textureSampler"),this._fragmentUrl=t,this._vertexUrl=d,this._parameters=i||[],this._parameters.push("scale"),this._indexParameters=g,y||this.updateEffect(l)}return Object.defineProperty(e.prototype,"samples",{get:function(){return this._samples},set:function(e){var t=this;this._samples=Math.min(e,this._engine.getCaps().maxMSAASamples),this._textures.forEach((function(e){e.samples!==t._samples&&t._engine.updateRenderTargetTextureSampleCount(e,t._samples)}))},enumerable:!0,configurable:!0}),e.prototype.getEffectName=function(){return this._fragmentUrl},Object.defineProperty(e.prototype,"onActivate",{set:function(e){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver),e&&(this._onActivateObserver=this.onActivateObservable.add(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSizeChanged",{set:function(e){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver),this._onSizeChangedObserver=this.onSizeChangedObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onApply",{set:function(e){this._onApplyObserver&&this.onApplyObservable.remove(this._onApplyObserver),this._onApplyObserver=this.onApplyObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputTexture",{get:function(){return this._textures.data[this._currentRenderTextureInd]},set:function(e){this._forcedOutputTexture=e},enumerable:!0,configurable:!0}),e.prototype.getCamera=function(){return this._camera},Object.defineProperty(e.prototype,"texelSize",{get:function(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.texelSize:(this._forcedOutputTexture&&this._texelSize.copyFromFloats(1/this._forcedOutputTexture.width,1/this._forcedOutputTexture.height),this._texelSize)},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"PostProcess"},e.prototype.getEngine=function(){return this._engine},e.prototype.getEffect=function(){return this._effect},e.prototype.shareOutputWith=function(e){return this._disposeTextures(),this._shareOutputWithPostProcess=e,this},e.prototype.useOwnOutput=function(){0==this._textures.length&&(this._textures=new s.a(2)),this._shareOutputWithPostProcess=null},e.prototype.updateEffect=function(e,t,i,s,n,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=null),this._effect=this._engine.createEffect({vertex:this._vertexUrl,fragment:this._fragmentUrl},["position"],t||this._parameters,i||this._samplers,null!==e?e:"",void 0,n,o,s||this._indexParameters)},e.prototype.isReusable=function(){return this._reusable},e.prototype.markTextureDirty=function(){this.width=-1},e.prototype.activate=function(e,t,i){var s=this;void 0===t&&(t=null);var n=(e=e||this._camera).getScene(),o=n.getEngine(),a=o.getCaps().maxTextureSize,c=(t?t.width:this._engine.getRenderWidth(!0))*this._options|0,h=(t?t.height:this._engine.getRenderHeight(!0))*this._options|0,p=e.parent;!p||p.leftCamera!=e&&p.rightCamera!=e||(c/=2);var u,l=this._options.width||c,f=this._options.height||h,d=7!==this.renderTargetSamplingMode&&1!==this.renderTargetSamplingMode&&2!==this.renderTargetSamplingMode;if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this.adaptScaleToCurrentViewport){var g=o.currentViewport;g&&(l*=g.width,f*=g.height)}if((d||this.alwaysForcePOT)&&(this._options.width||(l=o.needPOTTextures?r.a.GetExponentOfTwo(l,a,this.scaleMode):l),this._options.height||(f=o.needPOTTextures?r.a.GetExponentOfTwo(f,a,this.scaleMode):f)),this.width!==l||this.height!==f){if(this._textures.length>0){for(var y=0;y<this._textures.length;y++)this._engine._releaseTexture(this._textures.data[y]);this._textures.reset()}this.width=l,this.height=f;var _={width:this.width,height:this.height},b={generateMipMaps:d,generateDepthBuffer:i||0===e._postProcesses.indexOf(this),generateStencilBuffer:(i||0===e._postProcesses.indexOf(this))&&this._engine.isStencilEnable,samplingMode:this.renderTargetSamplingMode,type:this._textureType,format:this._textureFormat};this._textures.push(this._engine.createRenderTargetTexture(_,b)),this._reusable&&this._textures.push(this._engine.createRenderTargetTexture(_,b)),this._texelSize.copyFromFloats(1/this.width,1/this.height),this.onSizeChangedObservable.notifyObservers(this)}this._textures.forEach((function(e){e.samples!==s.samples&&s._engine.updateRenderTargetTextureSampleCount(e,s.samples)}))}return this._shareOutputWithPostProcess?u=this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?(u=this._forcedOutputTexture,this.width=this._forcedOutputTexture.width,this.height=this._forcedOutputTexture.height):u=this.inputTexture,this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(c/l,h/f),this._engine.bindFramebuffer(u,0,c,h,this.forceFullscreenViewport)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(u,0,void 0,void 0,this.forceFullscreenViewport)),this.onActivateObservable.notifyObservers(e),this.autoClear&&0===this.alphaMode&&this._engine.clear(this.clearColor?this.clearColor:n.clearColor,n._allowPostProcessClearColor,!0,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2),u},Object.defineProperty(e.prototype,"isSupported",{get:function(){return this._effect.isSupported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aspectRatio",{get:function(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.aspectRatio:this._forcedOutputTexture?this._forcedOutputTexture.width/this._forcedOutputTexture.height:this.width/this.height},enumerable:!0,configurable:!0}),e.prototype.isReady=function(){return this._effect&&this._effect.isReady()},e.prototype.apply=function(){return this._effect&&this._effect.isReady()?(this._engine.enableEffect(this._effect),this._engine.setState(!1),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._engine.setAlphaMode(this.alphaMode),this.alphaConstants&&this.getEngine().setAlphaConstants(this.alphaConstants.r,this.alphaConstants.g,this.alphaConstants.b,this.alphaConstants.a),e=this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?this._forcedOutputTexture:this.inputTexture,this._effect._bindTexture("textureSampler",e),this._effect.setVector2("scale",this._scaleRatio),this.onApplyObservable.notifyObservers(this._effect),this._effect):null;var e},e.prototype._disposeTextures=function(){if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this._textures.length>0)for(var e=0;e<this._textures.length;e++)this._engine._releaseTexture(this._textures.data[e]);this._textures.dispose()}},e.prototype.dispose=function(e){if(e=e||this._camera,this._disposeTextures(),this._scene){var t=this._scene.postProcesses.indexOf(this);-1!==t&&this._scene.postProcesses.splice(t,1)}else{var i=this._engine.postProcesses.indexOf(this);-1!==i&&this._engine.postProcesses.splice(i,1)}if(e){if(e.detachPostProcess(this),0===e._postProcesses.indexOf(this)&&e._postProcesses.length>0){var s=this._camera._getFirstPostProcess();s&&s.markTextureDirty()}this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear()}},e}())},WnUc:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("cdI9"),n=i("y4Ty"),o=function(){function e(e){this._vertexBuffers={},this._scene=e}return e.prototype._prepareBuffers=function(){if(!this._vertexBuffers[n.b.PositionKind]){var e=[];e.push(1,1),e.push(-1,1),e.push(-1,-1),e.push(1,-1),this._vertexBuffers[n.b.PositionKind]=new n.b(this._scene.getEngine(),e,n.b.PositionKind,!1,!1,2),this._buildIndexBuffer()}},e.prototype._buildIndexBuffer=function(){var e=[];e.push(0),e.push(1),e.push(2),e.push(0),e.push(2),e.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(e)},e.prototype._rebuild=function(){var e=this._vertexBuffers[n.b.PositionKind];e&&(e._rebuild(),this._buildIndexBuffer())},e.prototype._prepareFrame=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var i=this._scene.activeCamera;return!!i&&(!(!(t=t||i._postProcesses.filter((function(e){return null!=e})))||0===t.length||!this._scene.postProcessesEnabled)&&(t[0].activate(i,e,null!=t),!0))},e.prototype.directRender=function(e,t,i,n,o){void 0===t&&(t=null),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===o&&(o=0);for(var r=this._scene.getEngine(),a=0;a<e.length;a++){a<e.length-1?e[a+1].activate(this._scene.activeCamera,t):t?r.bindFramebuffer(t,n,void 0,void 0,i,o):r.restoreDefaultFramebuffer();var c=e[a],h=c.apply();h&&(c.onBeforeRenderObservable.notifyObservers(h),this._prepareBuffers(),r.bindBuffers(this._vertexBuffers,this._indexBuffer,h),r.drawElementsType(s.a.TriangleFillMode,0,6),c.onAfterRenderObservable.notifyObservers(h))}r.setDepthBuffer(!0),r.setDepthWrite(!0)},e.prototype._finalizeFrame=function(e,t,i,n,o){void 0===o&&(o=!1);var r=this._scene.activeCamera;if(r&&0!==(n=n||r._postProcesses.filter((function(e){return null!=e}))).length&&this._scene.postProcessesEnabled){for(var a=this._scene.getEngine(),c=0,h=n.length;c<h;c++){var p=n[c];if(c<h-1?p._outputTexture=n[c+1].activate(r,t):t?(a.bindFramebuffer(t,i,void 0,void 0,o),p._outputTexture=t):(a.restoreDefaultFramebuffer(),p._outputTexture=null),e)break;var u=p.apply();u&&(p.onBeforeRenderObservable.notifyObservers(u),this._prepareBuffers(),a.bindBuffers(this._vertexBuffers,this._indexBuffer,u),a.drawElementsType(s.a.TriangleFillMode,0,6),p.onAfterRenderObservable.notifyObservers(u))}a.setDepthBuffer(!0),a.setDepthWrite(!0),a.setAlphaMode(0)}},e.prototype.dispose=function(){var e=this._vertexBuffers[n.b.PositionKind];e&&(e.dispose(),this._vertexBuffers[n.b.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)},e}()},Z6LB:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var s=i("mrSG"),n=i("ADVu"),o=i("uyO6"),r=i("aCSs"),a=i("M8EM"),c=i("OJ6t"),h=(i("m5Hb"),function(e){function t(t,i,s,n,o,r,a,c){void 0===a&&(a=0),void 0===c&&(c=!1);var h=e.call(this,t,"sharpen",["sharpnessAmounts","screenSize"],null,i,s,n,o,r,null,a,void 0,null,c)||this;return h.colorAmount=1,h.edgeAmount=.3,h.onApply=function(e){e.setFloat2("screenSize",h.width,h.height),e.setFloat2("sharpnessAmounts",h.edgeAmount,h.colorAmount)},h}return Object(s.c)(t,e),t}(c.a)),p=i("stmW"),u=i("e2Mr"),l=(i("Ohe1"),i("+stD"),function(e){function t(t,i,s,n,o,r,a,c){void 0===s&&(s=null),void 0===a&&(a=0);var h=e.call(this,t,"imageProcessing",[],[],i,s,n,o,r,null,a,"postprocess",null,!0)||this;return h._fromLinearSpace=!0,h._defines={IMAGEPROCESSING:!1,VIGNETTE:!1,VIGNETTEBLENDMODEMULTIPLY:!1,VIGNETTEBLENDMODEOPAQUE:!1,TONEMAPPING:!1,TONEMAPPING_ACES:!1,CONTRAST:!1,COLORCURVES:!1,COLORGRADING:!1,COLORGRADING3D:!1,FROMLINEARSPACE:!1,SAMPLER3DGREENDEPTH:!1,SAMPLER3DBGRMAP:!1,IMAGEPROCESSINGPOSTPROCESS:!1,EXPOSURE:!1},c?(c.applyByPostProcess=!0,h._attachImageProcessingConfiguration(c,!0),h.fromLinearSpace=!1):(h._attachImageProcessingConfiguration(null,!0),h.imageProcessingConfiguration.applyByPostProcess=!0),h.onApply=function(e){h.imageProcessingConfiguration.bind(e,h.aspectRatio)},h}return Object(s.c)(t,e),Object.defineProperty(t.prototype,"imageProcessingConfiguration",{get:function(){return this._imageProcessingConfiguration},set:function(e){e.applyByPostProcess=!0,this._attachImageProcessingConfiguration(e)},enumerable:!0,configurable:!0}),t.prototype._attachImageProcessingConfiguration=function(e,t){var i=this;if(void 0===t&&(t=!1),e!==this._imageProcessingConfiguration){if(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e)this._imageProcessingConfiguration=e;else{var s=null,n=this.getEngine(),o=this.getCamera();if(o)s=o.getScene();else if(n&&n.scenes){var r=n.scenes;s=r[r.length-1]}else s=u.a.LastCreatedScene;this._imageProcessingConfiguration=s.imageProcessingConfiguration}this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((function(){i._updateParameters()}))),t||this._updateParameters()}},Object.defineProperty(t.prototype,"colorCurves",{get:function(){return this.imageProcessingConfiguration.colorCurves},set:function(e){this.imageProcessingConfiguration.colorCurves=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorCurvesEnabled",{get:function(){return this.imageProcessingConfiguration.colorCurvesEnabled},set:function(e){this.imageProcessingConfiguration.colorCurvesEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorGradingTexture",{get:function(){return this.imageProcessingConfiguration.colorGradingTexture},set:function(e){this.imageProcessingConfiguration.colorGradingTexture=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorGradingEnabled",{get:function(){return this.imageProcessingConfiguration.colorGradingEnabled},set:function(e){this.imageProcessingConfiguration.colorGradingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exposure",{get:function(){return this.imageProcessingConfiguration.exposure},set:function(e){this.imageProcessingConfiguration.exposure=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toneMappingEnabled",{get:function(){return this._imageProcessingConfiguration.toneMappingEnabled},set:function(e){this._imageProcessingConfiguration.toneMappingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toneMappingType",{get:function(){return this._imageProcessingConfiguration.toneMappingType},set:function(e){this._imageProcessingConfiguration.toneMappingType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contrast",{get:function(){return this.imageProcessingConfiguration.contrast},set:function(e){this.imageProcessingConfiguration.contrast=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteStretch",{get:function(){return this.imageProcessingConfiguration.vignetteStretch},set:function(e){this.imageProcessingConfiguration.vignetteStretch=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteCentreX",{get:function(){return this.imageProcessingConfiguration.vignetteCentreX},set:function(e){this.imageProcessingConfiguration.vignetteCentreX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteCentreY",{get:function(){return this.imageProcessingConfiguration.vignetteCentreY},set:function(e){this.imageProcessingConfiguration.vignetteCentreY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteWeight",{get:function(){return this.imageProcessingConfiguration.vignetteWeight},set:function(e){this.imageProcessingConfiguration.vignetteWeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteColor",{get:function(){return this.imageProcessingConfiguration.vignetteColor},set:function(e){this.imageProcessingConfiguration.vignetteColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteCameraFov",{get:function(){return this.imageProcessingConfiguration.vignetteCameraFov},set:function(e){this.imageProcessingConfiguration.vignetteCameraFov=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteBlendMode",{get:function(){return this.imageProcessingConfiguration.vignetteBlendMode},set:function(e){this.imageProcessingConfiguration.vignetteBlendMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vignetteEnabled",{get:function(){return this.imageProcessingConfiguration.vignetteEnabled},set:function(e){this.imageProcessingConfiguration.vignetteEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fromLinearSpace",{get:function(){return this._fromLinearSpace},set:function(e){this._fromLinearSpace!==e&&(this._fromLinearSpace=e,this._updateParameters())},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"ImageProcessingPostProcess"},t.prototype._updateParameters=function(){this._defines.FROMLINEARSPACE=this._fromLinearSpace,this.imageProcessingConfiguration.prepareDefines(this._defines,!0);var e="";for(var t in this._defines)this._defines[t]&&(e+="#define "+t+";\r\n");var i=["textureSampler"],s=["scale"];p.a&&(p.a.PrepareSamplers(i,this._defines),p.a.PrepareUniforms(s,this._defines)),this.updateEffect(e,s,i)},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration&&(this.imageProcessingConfiguration.applyByPostProcess=!1)},Object(s.b)([Object(n.c)()],t.prototype,"_fromLinearSpace",void 0),t}(c.a)),f=i("/SR9"),d=(i("IbxF"),function(e){function t(t,i,s,n,o,r,a,c,h,p){void 0===h&&(h=0),void 0===p&&(p=!1);var u=e.call(this,t,"chromaticAberration",["chromatic_aberration","screen_width","screen_height","direction","radialIntensity","centerPosition"],[],n,o,r,a,c,null,h,void 0,null,p)||this;return u.aberrationAmount=30,u.radialIntensity=0,u.direction=new f.d(.707,.707),u.centerPosition=new f.d(.5,.5),u.onApplyObservable.add((function(e){e.setFloat("chromatic_aberration",u.aberrationAmount),e.setFloat("screen_width",i),e.setFloat("screen_height",s),e.setFloat("radialIntensity",u.radialIntensity),e.setFloat2("direction",u.direction.x,u.direction.y),e.setFloat2("centerPosition",u.centerPosition.x,u.centerPosition.y)})),u}return Object(s.c)(t,e),t}(c.a)),g=(i("/cGC"),function(e){function t(t,i,s,n,o,r,a,c){void 0===a&&(a=0),void 0===c&&(c=!1);var h=e.call(this,t,"grain",["intensity","animatedSeed"],[],i,s,n,o,r,null,a,void 0,null,c)||this;return h.intensity=30,h.animated=!1,h.onApplyObservable.add((function(e){e.setFloat("intensity",h.intensity),e.setFloat("animatedSeed",h.animated?Math.random()+1:1)})),h}return Object(s.c)(t,e),t}(c.a)),y=(i("SMV4"),i("q4Q+"),function(e){function t(t,i,s,n,o,a,c){void 0===s&&(s=null),void 0===c&&(c=0);var h=e.call(this,t,"fxaa",["texelSize"],null,i,s,n||r.a.BILINEAR_SAMPLINGMODE,o,a,null,c,"fxaa",void 0,!0)||this,p=h._getDefines();return h.updateEffect(p),h.onApplyObservable.add((function(e){var t=h.texelSize;e.setFloat2("texelSize",t.x,t.y)})),h}return Object(s.c)(t,e),t.prototype._getDefines=function(){var e=this.getEngine();if(!e)return null;var t=e.getGlInfo();return t&&t.renderer&&t.renderer.toLowerCase().indexOf("mali")>-1?"#define MALI 1\n":null},t}(c.a)),_=i("YKqZ"),b=function(){function e(e,t){this.engine=e,this._name=t,this._renderEffects={},this._renderEffectsForIsolatedPass=new Array,this._cameras=[]}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cameras",{get:function(){return this._cameras},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"PostProcessRenderPipeline"},Object.defineProperty(e.prototype,"isSupported",{get:function(){for(var e in this._renderEffects)if(this._renderEffects.hasOwnProperty(e)&&!this._renderEffects[e].isSupported)return!1;return!0},enumerable:!0,configurable:!0}),e.prototype.addEffect=function(e){this._renderEffects[e._name]=e},e.prototype._rebuild=function(){},e.prototype._enableEffect=function(e,t){var i=this._renderEffects[e];i&&i._enable(_.b.MakeArray(t||this._cameras))},e.prototype._disableEffect=function(e,t){var i=this._renderEffects[e];i&&i._disable(_.b.MakeArray(t||this._cameras))},e.prototype._attachCameras=function(e,t){var i=_.b.MakeArray(e||this._cameras);if(i){var s,n=[];for(s=0;s<i.length;s++){var o=i[s],r=o.name;-1===this._cameras.indexOf(o)?this._cameras[r]=o:t&&n.push(s)}for(s=0;s<n.length;s++)e.splice(n[s],1);for(var a in this._renderEffects)this._renderEffects.hasOwnProperty(a)&&this._renderEffects[a]._attachCameras(i)}},e.prototype._detachCameras=function(e){var t=_.b.MakeArray(e||this._cameras);if(t){for(var i in this._renderEffects)this._renderEffects.hasOwnProperty(i)&&this._renderEffects[i]._detachCameras(t);for(var s=0;s<t.length;s++)this._cameras.splice(this._cameras.indexOf(t[s]),1)}},e.prototype._update=function(){for(var e in this._renderEffects)this._renderEffects.hasOwnProperty(e)&&this._renderEffects[e]._update();for(var t=0;t<this._cameras.length;t++){var i=this._cameras[t].name;this._renderEffectsForIsolatedPass[i]&&this._renderEffectsForIsolatedPass[i]._update()}},e.prototype._reset=function(){this._renderEffects={},this._renderEffectsForIsolatedPass=new Array},e.prototype._enableMSAAOnFirstPostProcess=function(e){if(1===this.engine.webGLVersion)return!1;var t=Object.keys(this._renderEffects);if(t.length>0){var i=this._renderEffects[t[0]].getPostProcesses();i&&(i[0].samples=e)}return!0},e.prototype.dispose=function(){},Object(s.b)([Object(n.c)()],e.prototype,"_name",void 0),e}(),m=i("dypj"),P=i("skBc"),v=i("MhaC"),O=(i("7OwZ"),function(e){function t(t,i,s,n,o,r,a,c){void 0===a&&(a=0),void 0===c&&(c=!1);var h=e.call(this,t,"extractHighlights",["threshold","exposure"],null,i,s,n,o,r,null,a,void 0,null,c)||this;return h.threshold=.9,h._exposure=1,h._inputPostProcess=null,h.onApplyObservable.add((function(e){h._inputPostProcess&&e.setTextureFromPostProcess("textureSampler",h._inputPostProcess),e.setFloat("threshold",Math.pow(h.threshold,v.b)),e.setFloat("exposure",h._exposure)})),h}return Object(s.c)(t,e),t}(c.a)),E=i("AGTA"),x=(i("DOQd"),function(e){function t(t,i,s,n,o,r,a,c,h,p,u){void 0===p&&(p=0),void 0===u&&(u=!1);var l=e.call(this,t,"bloomMerge",["bloomWeight"],["circleOfConfusionSampler","blurStep0","blurStep1","blurStep2","bloomBlur"],o,r,a,c,h,null,p,void 0,null,!0)||this;return l.weight=n,l.onApplyObservable.add((function(e){e.setTextureFromPostProcess("textureSampler",i),e.setTextureFromPostProcessOutput("bloomBlur",s),e.setFloat("bloomWeight",l.weight)})),u||l.updateEffect(),l}return Object(s.c)(t,e),t}(c.a)),C=function(e){function t(t,i,s,n,o,a){void 0===o&&(o=0),void 0===a&&(a=!1);var c=e.call(this,t.getEngine(),"bloom",(function(){return c._effects}),!0)||this;return c.bloomScale=i,c._effects=[],c._downscale=new O("highlights",1,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,o,a),c._blurX=new E.a("horizontal blur",new f.d(1,0),10,i,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,o,void 0,a),c._blurX.alwaysForcePOT=!0,c._blurX.autoClear=!1,c._blurY=new E.a("vertical blur",new f.d(0,1),10,i,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,o,void 0,a),c._blurY.alwaysForcePOT=!0,c._blurY.autoClear=!1,c.kernel=n,c._effects=[c._downscale,c._blurX,c._blurY],c._merge=new x("bloomMerge",c._downscale,c._blurY,s,i,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,o,a),c._merge.autoClear=!1,c._effects.push(c._merge),c}return Object(s.c)(t,e),Object.defineProperty(t.prototype,"threshold",{get:function(){return this._downscale.threshold},set:function(e){this._downscale.threshold=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this._merge.weight},set:function(e){this._merge.weight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernel",{get:function(){return this._blurX.kernel/this.bloomScale},set:function(e){this._blurX.kernel=e*this.bloomScale,this._blurY.kernel=e*this.bloomScale},enumerable:!0,configurable:!0}),t.prototype.disposeEffects=function(e){for(var t=0;t<this._effects.length;t++)this._effects[t].dispose(e)},t.prototype._updateEffects=function(){for(var e=0;e<this._effects.length;e++)this._effects[e].updateEffect()},t.prototype._isReady=function(){for(var e=0;e<this._effects.length;e++)if(!this._effects[e].isReady())return!1;return!0},t}(m.a),S=i("WHS4"),A=i("Yap0"),I=function(){function e(){this._renderPipelines={}}return Object.defineProperty(e.prototype,"supportedPipelines",{get:function(){var e=[];for(var t in this._renderPipelines)if(this._renderPipelines.hasOwnProperty(t)){var i=this._renderPipelines[t];i.isSupported&&e.push(i)}return e},enumerable:!0,configurable:!0}),e.prototype.addPipeline=function(e){this._renderPipelines[e._name]=e},e.prototype.attachCamerasToRenderPipeline=function(e,t,i){void 0===i&&(i=!1);var s=this._renderPipelines[e];s&&s._attachCameras(t,i)},e.prototype.detachCamerasFromRenderPipeline=function(e,t){var i=this._renderPipelines[e];i&&i._detachCameras(t)},e.prototype.enableEffectInPipeline=function(e,t,i){var s=this._renderPipelines[e];s&&s._enableEffect(t,i)},e.prototype.disableEffectInPipeline=function(e,t,i){var s=this._renderPipelines[e];s&&s._disableEffect(t,i)},e.prototype.update=function(){for(var e in this._renderPipelines)if(this._renderPipelines.hasOwnProperty(e)){var t=this._renderPipelines[e];t.isSupported?t._update():(t.dispose(),delete this._renderPipelines[e])}},e.prototype._rebuild=function(){for(var e in this._renderPipelines){if(this._renderPipelines.hasOwnProperty(e))this._renderPipelines[e]._rebuild()}},e.prototype.dispose=function(){for(var e in this._renderPipelines){if(this._renderPipelines.hasOwnProperty(e))this._renderPipelines[e].dispose()}},e}(),j=i("tVVT");Object.defineProperty(j.a.prototype,"postProcessRenderPipelineManager",{get:function(){if(!this._postProcessRenderPipelineManager){var e=this._getComponent(A.a.NAME_POSTPROCESSRENDERPIPELINEMANAGER);e||(e=new T(this),this._addComponent(e)),this._postProcessRenderPipelineManager=new I}return this._postProcessRenderPipelineManager},enumerable:!0,configurable:!0});var T=function(){function e(e){this.name=A.a.NAME_POSTPROCESSRENDERPIPELINEMANAGER,this.scene=e}return e.prototype.register=function(){this.scene._gatherRenderTargetsStage.registerStep(A.a.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER,this,this._gatherRenderTargets)},e.prototype.rebuild=function(){this.scene._postProcessRenderPipelineManager&&this.scene._postProcessRenderPipelineManager._rebuild()},e.prototype.dispose=function(){this.scene._postProcessRenderPipelineManager&&this.scene._postProcessRenderPipelineManager.dispose()},e.prototype._gatherRenderTargets=function(){this.scene._postProcessRenderPipelineManager&&this.scene._postProcessRenderPipelineManager.update()},e}(),R=function(e){function t(t,i,s,n,o){void 0===t&&(t=""),void 0===i&&(i=!0),void 0===s&&(s=u.a.LastCreatedScene),void 0===o&&(o=!0);var a=e.call(this,s.getEngine(),t)||this;a._camerasToBeAttached=[],a.SharpenPostProcessId="SharpenPostProcessEffect",a.ImageProcessingPostProcessId="ImageProcessingPostProcessEffect",a.FxaaPostProcessId="FxaaPostProcessEffect",a.ChromaticAberrationPostProcessId="ChromaticAberrationPostProcessEffect",a.GrainPostProcessId="GrainPostProcessEffect",a._glowLayer=null,a.animations=[],a._imageProcessingConfigurationObserver=null,a._sharpenEnabled=!1,a._bloomEnabled=!1,a._depthOfFieldEnabled=!1,a._depthOfFieldBlurLevel=P.b.Low,a._fxaaEnabled=!1,a._imageProcessingEnabled=!0,a._bloomScale=.5,a._chromaticAberrationEnabled=!1,a._grainEnabled=!1,a._buildAllowed=!0,a._resizeObserver=null,a._hardwareScaleLevel=1,a._bloomKernel=64,a._bloomWeight=.15,a._bloomThreshold=.9,a._samples=1,a._hasCleared=!1,a._prevPostProcess=null,a._prevPrevPostProcess=null,a._depthOfFieldSceneObserver=null,a._cameras=n||s.cameras,a._cameras=a._cameras.slice(),a._camerasToBeAttached=a._cameras.slice(),a._buildAllowed=o,a._scene=s;var c=a._scene.getEngine().getCaps();a._hdr=i&&(c.textureHalfFloatRender||c.textureFloatRender),a._hdr?c.textureHalfFloatRender?a._defaultPipelineTextureType=2:c.textureFloatRender&&(a._defaultPipelineTextureType=1):a._defaultPipelineTextureType=0,s.postProcessRenderPipelineManager.addPipeline(a);var p=a._scene.getEngine();return a.sharpen=new h("sharpen",1,null,r.a.BILINEAR_SAMPLINGMODE,p,!1,a._defaultPipelineTextureType,!0),a._sharpenEffect=new m.a(p,a.SharpenPostProcessId,(function(){return a.sharpen}),!0),a.depthOfField=new P.a(a._scene,null,a._depthOfFieldBlurLevel,a._defaultPipelineTextureType,!0),a.bloom=new C(a._scene,a._bloomScale,a._bloomWeight,a.bloomKernel,a._defaultPipelineTextureType,!0),a.chromaticAberration=new d("ChromaticAberration",p.getRenderWidth(),p.getRenderHeight(),1,null,r.a.BILINEAR_SAMPLINGMODE,p,!1,a._defaultPipelineTextureType,!0),a._chromaticAberrationEffect=new m.a(p,a.ChromaticAberrationPostProcessId,(function(){return a.chromaticAberration}),!0),a.grain=new g("Grain",1,null,r.a.BILINEAR_SAMPLINGMODE,p,!1,a._defaultPipelineTextureType,!0),a._grainEffect=new m.a(p,a.GrainPostProcessId,(function(){return a.grain}),!0),a._resizeObserver=p.onResizeObservable.add((function(){a._hardwareScaleLevel=p.getHardwareScalingLevel(),a.bloomKernel=a.bloomKernel})),a._imageProcessingConfigurationObserver=a._scene.imageProcessingConfiguration.onUpdateParameters.add((function(){a.bloom._downscale._exposure=a._scene.imageProcessingConfiguration.exposure})),a._buildPipeline(),a}return Object(s.c)(t,e),Object.defineProperty(t.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sharpenEnabled",{get:function(){return this._sharpenEnabled},set:function(e){this._sharpenEnabled!==e&&(this._sharpenEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloomKernel",{get:function(){return this._bloomKernel},set:function(e){this._bloomKernel=e,this.bloom.kernel=e/this._hardwareScaleLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloomWeight",{get:function(){return this._bloomWeight},set:function(e){this._bloomWeight!==e&&(this.bloom.weight=e,this._bloomWeight=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloomThreshold",{get:function(){return this._bloomThreshold},set:function(e){this._bloomThreshold!==e&&(this.bloom.threshold=e,this._bloomThreshold=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloomScale",{get:function(){return this._bloomScale},set:function(e){this._bloomScale!==e&&(this._bloomScale=e,this._rebuildBloom(),this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloomEnabled",{get:function(){return this._bloomEnabled},set:function(e){this._bloomEnabled!==e&&(this._bloomEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),t.prototype._rebuildBloom=function(){var e=this.bloom;this.bloom=new C(this._scene,this.bloomScale,this._bloomWeight,this.bloomKernel,this._defaultPipelineTextureType,!1),this.bloom.threshold=e.threshold;for(var t=0;t<this._cameras.length;t++)e.disposeEffects(this._cameras[t])},Object.defineProperty(t.prototype,"depthOfFieldEnabled",{get:function(){return this._depthOfFieldEnabled},set:function(e){this._depthOfFieldEnabled!==e&&(this._depthOfFieldEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthOfFieldBlurLevel",{get:function(){return this._depthOfFieldBlurLevel},set:function(e){if(this._depthOfFieldBlurLevel!==e){this._depthOfFieldBlurLevel=e;var t=this.depthOfField;this.depthOfField=new P.a(this._scene,null,this._depthOfFieldBlurLevel,this._defaultPipelineTextureType,!1),this.depthOfField.focalLength=t.focalLength,this.depthOfField.focusDistance=t.focusDistance,this.depthOfField.fStop=t.fStop,this.depthOfField.lensSize=t.lensSize;for(var i=0;i<this._cameras.length;i++)t.disposeEffects(this._cameras[i]);this._buildPipeline()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fxaaEnabled",{get:function(){return this._fxaaEnabled},set:function(e){this._fxaaEnabled!==e&&(this._fxaaEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"samples",{get:function(){return this._samples},set:function(e){this._samples!==e&&(this._samples=e,this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageProcessingEnabled",{get:function(){return this._imageProcessingEnabled},set:function(e){this._imageProcessingEnabled!==e&&(this._imageProcessingEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glowLayerEnabled",{get:function(){return null!=this._glowLayer},set:function(e){e&&!this._glowLayer?this._glowLayer=new a.a("",this._scene):!e&&this._glowLayer&&(this._glowLayer.dispose(),this._glowLayer=null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glowLayer",{get:function(){return this._glowLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chromaticAberrationEnabled",{get:function(){return this._chromaticAberrationEnabled},set:function(e){this._chromaticAberrationEnabled!==e&&(this._chromaticAberrationEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"grainEnabled",{get:function(){return this._grainEnabled},set:function(e){this._grainEnabled!==e&&(this._grainEnabled=e,this._buildPipeline())},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"DefaultRenderingPipeline"},t.prototype.prepare=function(){var e=this._buildAllowed;this._buildAllowed=!0,this._buildPipeline(),this._buildAllowed=e},t.prototype._setAutoClearAndTextureSharing=function(e,t){void 0===t&&(t=!1),this._hasCleared?e.autoClear=!1:(e.autoClear=!0,this._scene.autoClear=!1,this._hasCleared=!0),t||(this._prevPrevPostProcess?e.shareOutputWith(this._prevPrevPostProcess):e.useOwnOutput(),this._prevPostProcess&&(this._prevPrevPostProcess=this._prevPostProcess),this._prevPostProcess=e)},t.prototype._buildPipeline=function(){var e=this;if(this._buildAllowed){this._scene.autoClear=!0;var t=this._scene.getEngine();if(this._disposePostProcesses(),null!==this._cameras&&(this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._cameras),this._cameras=this._camerasToBeAttached.slice()),this._reset(),this._prevPostProcess=null,this._prevPrevPostProcess=null,this._hasCleared=!1,this.depthOfFieldEnabled){if(this._cameras.length>1){for(var i=0,s=this._cameras;i<s.length;i++){var n=s[i];(a=this._scene.enableDepthRenderer(n)).useOnlyInActiveCamera=!0}this._depthOfFieldSceneObserver=this._scene.onAfterRenderTargetsRenderObservable.add((function(t){e._cameras.indexOf(t.activeCamera)>-1&&(e.depthOfField.depthTexture=t.enableDepthRenderer(t.activeCamera).getDepthMap())}))}else{this._scene.onAfterRenderTargetsRenderObservable.remove(this._depthOfFieldSceneObserver);var a=this._scene.enableDepthRenderer(this._cameras[0]);this.depthOfField.depthTexture=a.getDepthMap()}this.depthOfField._isReady()||this.depthOfField._updateEffects(),this.addEffect(this.depthOfField),this._setAutoClearAndTextureSharing(this.depthOfField._effects[0],!0)}else this._scene.onAfterRenderTargetsRenderObservable.remove(this._depthOfFieldSceneObserver);this.bloomEnabled&&(this.bloom._isReady()||this.bloom._updateEffects(),this.addEffect(this.bloom),this._setAutoClearAndTextureSharing(this.bloom._effects[0],!0)),this._imageProcessingEnabled&&(this.imageProcessing=new l("imageProcessing",1,null,r.a.BILINEAR_SAMPLINGMODE,t,!1,this._defaultPipelineTextureType),this._hdr?(this.addEffect(new m.a(t,this.ImageProcessingPostProcessId,(function(){return e.imageProcessing}),!0)),this._setAutoClearAndTextureSharing(this.imageProcessing)):this._scene.imageProcessingConfiguration.applyByPostProcess=!1),this.sharpenEnabled&&(this.sharpen.isReady()||this.sharpen.updateEffect(),this.addEffect(this._sharpenEffect),this._setAutoClearAndTextureSharing(this.sharpen)),this.grainEnabled&&(this.grain.isReady()||this.grain.updateEffect(),this.addEffect(this._grainEffect),this._setAutoClearAndTextureSharing(this.grain)),this.chromaticAberrationEnabled&&(this.chromaticAberration.isReady()||this.chromaticAberration.updateEffect(),this.addEffect(this._chromaticAberrationEffect),this._setAutoClearAndTextureSharing(this.chromaticAberration)),this.fxaaEnabled&&(this.fxaa=new y("fxaa",1,null,r.a.BILINEAR_SAMPLINGMODE,t,!1,this._defaultPipelineTextureType),this.addEffect(new m.a(t,this.FxaaPostProcessId,(function(){return e.fxaa}),!0)),this._setAutoClearAndTextureSharing(this.fxaa,!0)),null!==this._cameras&&this._scene.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(this._name,this._cameras),this._scene.activeCameras&&this._scene.activeCameras.length>1&&(this._scene.autoClear=!0),!this._enableMSAAOnFirstPostProcess(this.samples)&&this.samples>1&&o.a.Warn("MSAA failed to enable, MSAA is only supported in browsers that support webGL >= 2.0")}},t.prototype._disposePostProcesses=function(e){void 0===e&&(e=!1);for(var t=0;t<this._cameras.length;t++){var i=this._cameras[t];this.imageProcessing&&this.imageProcessing.dispose(i),this.fxaa&&this.fxaa.dispose(i),e&&(this.sharpen&&this.sharpen.dispose(i),this.depthOfField&&(this._scene.onAfterRenderTargetsRenderObservable.remove(this._depthOfFieldSceneObserver),this.depthOfField.disposeEffects(i)),this.bloom&&this.bloom.disposeEffects(i),this.chromaticAberration&&this.chromaticAberration.dispose(i),this.grain&&this.grain.dispose(i),this._glowLayer&&this._glowLayer.dispose())}this.imageProcessing=null,this.fxaa=null,e&&(this.sharpen=null,this._sharpenEffect=null,this.depthOfField=null,this.bloom=null,this.chromaticAberration=null,this._chromaticAberrationEffect=null,this.grain=null,this._grainEffect=null,this._glowLayer=null)},t.prototype.addCamera=function(e){this._camerasToBeAttached.push(e),this._buildPipeline()},t.prototype.removeCamera=function(e){var t=this._camerasToBeAttached.indexOf(e);this._camerasToBeAttached.splice(t,1),this._buildPipeline()},t.prototype.dispose=function(){this._disposePostProcesses(!0),this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._cameras),this._scene.autoClear=!0,this._resizeObserver&&(this._scene.getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this._scene.imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingConfigurationObserver),e.prototype.dispose.call(this)},t.prototype.serialize=function(){var e=n.a.Serialize(this);return e.customType="DefaultRenderingPipeline",e},t.Parse=function(e,i,s){return n.a.Parse((function(){return new t(e._name,e._name._hdr,i)}),e,i,s)},Object(s.b)([Object(n.c)()],t.prototype,"sharpenEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"bloomKernel",null),Object(s.b)([Object(n.c)()],t.prototype,"_bloomWeight",void 0),Object(s.b)([Object(n.c)()],t.prototype,"_bloomThreshold",void 0),Object(s.b)([Object(n.c)()],t.prototype,"_hdr",void 0),Object(s.b)([Object(n.c)()],t.prototype,"bloomWeight",null),Object(s.b)([Object(n.c)()],t.prototype,"bloomThreshold",null),Object(s.b)([Object(n.c)()],t.prototype,"bloomScale",null),Object(s.b)([Object(n.c)()],t.prototype,"bloomEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"depthOfFieldEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"depthOfFieldBlurLevel",null),Object(s.b)([Object(n.c)()],t.prototype,"fxaaEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"samples",null),Object(s.b)([Object(n.c)()],t.prototype,"imageProcessingEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"glowLayerEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"chromaticAberrationEnabled",null),Object(s.b)([Object(n.c)()],t.prototype,"grainEnabled",null),t}(b);S.a.RegisteredTypes["BABYLON.DefaultRenderingPipeline"]=R},dypj:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("YKqZ"),n=function(){function e(e,t,i,s){this._name=t,this._singleInstance=s||!0,this._getPostProcesses=i,this._cameras={},this._indicesForCamera={},this._postProcesses={}}return Object.defineProperty(e.prototype,"isSupported",{get:function(){for(var e in this._postProcesses)if(this._postProcesses.hasOwnProperty(e))for(var t=this._postProcesses[e],i=0;i<t.length;i++)if(!t[i].isSupported)return!1;return!0},enumerable:!0,configurable:!0}),e.prototype._update=function(){},e.prototype._attachCameras=function(e){var t,i=this,n=s.b.MakeArray(e||this._cameras);if(n)for(var o=0;o<n.length;o++){var r=n[o],a=r.name;if(t=this._singleInstance?0:a,!this._postProcesses[t]){var c=this._getPostProcesses();c&&(this._postProcesses[t]=Array.isArray(c)?c:[c])}this._indicesForCamera[a]||(this._indicesForCamera[a]=[]),this._postProcesses[t].forEach((function(e){var t=r.attachPostProcess(e);i._indicesForCamera[a].push(t)})),this._cameras[a]||(this._cameras[a]=r)}},e.prototype._detachCameras=function(e){var t=s.b.MakeArray(e||this._cameras);if(t)for(var i=0;i<t.length;i++){var n=t[i],o=n.name,r=this._postProcesses[this._singleInstance?0:o];r&&r.forEach((function(e){n.detachPostProcess(e)})),this._cameras[o]&&(this._cameras[o]=null)}},e.prototype._enable=function(e){var t=this,i=s.b.MakeArray(e||this._cameras);if(i)for(var n=0;n<i.length;n++)for(var o=i[n],r=o.name,a=0;a<this._indicesForCamera[r].length;a++)void 0!==o._postProcesses[this._indicesForCamera[r][a]]&&null!==o._postProcesses[this._indicesForCamera[r][a]]||this._postProcesses[this._singleInstance?0:r].forEach((function(e){i[n].attachPostProcess(e,t._indicesForCamera[r][a])}))},e.prototype._disable=function(e){var t=s.b.MakeArray(e||this._cameras);if(t)for(var i=0;i<t.length;i++){var n=t[i],o=n.name;this._postProcesses[this._singleInstance?0:o].forEach((function(e){n.detachPostProcess(e)}))}},e.prototype.getPostProcesses=function(e){return this._singleInstance?this._postProcesses[0]:e?this._postProcesses[e.name]:null},e}()},"e/hQ":function(e,t,i){"use strict";var s=i("uyO6"),n=i("ps+7"),o=i("ikaq"),r=i("Yap0"),a=i("tVVT"),c=i("3kgD"),h=i("4gN4");a.a.prototype.getPhysicsEngine=function(){return this._physicsEngine},a.a.prototype.enablePhysics=function(e,t){if(void 0===e&&(e=null),this._physicsEngine)return!0;var i=this._getComponent(r.a.NAME_PHYSICSENGINE);i||(i=new p(this),this._addComponent(i));try{return this._physicsEngine=new c.a(e,t),this._physicsTimeAccumulator=0,!0}catch(e){return s.a.Error(e.message),!1}},a.a.prototype.disablePhysicsEngine=function(){this._physicsEngine&&(this._physicsEngine.dispose(),this._physicsEngine=null)},a.a.prototype.isPhysicsEnabled=function(){return void 0!==this._physicsEngine},a.a.prototype.deleteCompoundImpostor=function(e){var t=e.parts[0].mesh;t.physicsImpostor&&(t.physicsImpostor.dispose(),t.physicsImpostor=null)},a.a.prototype._advancePhysicsEngineStep=function(e){if(this._physicsEngine){var t=this._physicsEngine.getSubTimeStep();if(t>0)for(this._physicsTimeAccumulator+=e;this._physicsTimeAccumulator>t;)this.onBeforePhysicsObservable.notifyObservers(this),this._physicsEngine._step(t/1e3),this.onAfterPhysicsObservable.notifyObservers(this),this._physicsTimeAccumulator-=t;else this.onBeforePhysicsObservable.notifyObservers(this),this._physicsEngine._step(e/1e3),this.onAfterPhysicsObservable.notifyObservers(this)}},Object.defineProperty(o.a.prototype,"physicsImpostor",{get:function(){return this._physicsImpostor},set:function(e){var t=this;this._physicsImpostor!==e&&(this._disposePhysicsObserver&&this.onDisposeObservable.remove(this._disposePhysicsObserver),this._physicsImpostor=e,e&&(this._disposePhysicsObserver=this.onDisposeObservable.add((function(){t.physicsImpostor&&(t.physicsImpostor.dispose(),t.physicsImpostor=null)}))))},enumerable:!0,configurable:!0}),o.a.prototype.getPhysicsImpostor=function(){return this.physicsImpostor},o.a.prototype.applyImpulse=function(e,t){return this.physicsImpostor?(this.physicsImpostor.applyImpulse(e,t),this):this},o.a.prototype.setPhysicsLinkWith=function(e,t,i,s){return this.physicsImpostor&&e.physicsImpostor?(this.physicsImpostor.createJoint(e.physicsImpostor,h.a.HingeJoint,{mainPivot:t,connectedPivot:i,nativeParams:s}),this):this};var p=function(){function e(e){var t=this;this.name=r.a.NAME_PHYSICSENGINE,this.scene=e,this.scene.onBeforePhysicsObservable=new n.a,this.scene.onAfterPhysicsObservable=new n.a,this.scene.getDeterministicFrameTime=function(){return t.scene._physicsEngine?1e3*t.scene._physicsEngine.getTimeStep():1e3/60}}return e.prototype.register=function(){},e.prototype.rebuild=function(){},e.prototype.dispose=function(){this.scene.onBeforePhysicsObservable.clear(),this.scene.onAfterPhysicsObservable.clear(),this.scene._physicsEngine&&this.scene.disablePhysicsEngine()},e}()},"iD+g":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var s=i("LVN+"),n=i("4gN4"),o=i("3kgD"),r=i("/SR9"),a=i("uyO6"),c=function(){function e(){this._hasHit=!1,this._hitDistance=0,this._hitNormalWorld=r.e.Zero(),this._hitPointWorld=r.e.Zero(),this._rayFromWorld=r.e.Zero(),this._rayToWorld=r.e.Zero()}return Object.defineProperty(e.prototype,"hasHit",{get:function(){return this._hasHit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitDistance",{get:function(){return this._hitDistance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitNormalWorld",{get:function(){return this._hitNormalWorld},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitPointWorld",{get:function(){return this._hitPointWorld},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rayFromWorld",{get:function(){return this._rayFromWorld},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rayToWorld",{get:function(){return this._rayToWorld},enumerable:!0,configurable:!0}),e.prototype.setHitData=function(e,t){this._hasHit=!0,this._hitNormalWorld=new r.e(e.x,e.y,e.z),this._hitPointWorld=new r.e(t.x,t.y,t.z)},e.prototype.setHitDistance=function(e){this._hitDistance=e},e.prototype.calculateHitDistance=function(){this._hitDistance=r.e.Distance(this._rayFromWorld,this._hitPointWorld)},e.prototype.reset=function(e,t){void 0===e&&(e=r.e.Zero()),void 0===t&&(t=r.e.Zero()),this._rayFromWorld=e,this._rayToWorld=t,this._hasHit=!1,this._hitDistance=0,this._hitNormalWorld=r.e.Zero(),this._hitPointWorld=r.e.Zero()},e}(),h=function(){function e(e,t){void 0===t&&(t=OIMO),this.name="OimoJSPlugin",this._tmpImpostorsArray=[],this._tmpPositionVector=r.e.Zero(),this.BJSOIMO=t,this.world=new this.BJSOIMO.World({iterations:e}),this.world.clear(),this._raycastResult=new c}return e.prototype.setGravity=function(e){this.world.gravity.copy(e)},e.prototype.setTimeStep=function(e){this.world.timeStep=e},e.prototype.getTimeStep=function(){return this.world.timeStep},e.prototype.executeStep=function(e,t){var i=this;t.forEach((function(e){e.beforeStep()})),this.world.step(),t.forEach((function(e){e.afterStep(),i._tmpImpostorsArray[e.uniqueId]=e}));for(var s=this.world.contacts;null!==s;)if(!s.touching||s.body1.sleeping||s.body2.sleeping){var n=this._tmpImpostorsArray[+s.body1.name],o=this._tmpImpostorsArray[+s.body2.name];n&&o?(n.onCollide({body:o.physicsBody}),o.onCollide({body:n.physicsBody}),s=s.next):s=s.next}else s=s.next},e.prototype.applyImpulse=function(e,t,i){var s=e.physicsBody.mass;e.physicsBody.applyImpulse(i.scale(this.world.invScale),t.scale(this.world.invScale*s))},e.prototype.applyForce=function(e,t,i){a.a.Warn("Oimo doesn't support applying force. Using impule instead."),this.applyImpulse(e,t,i)},e.prototype.generatePhysicsBody=function(e){var t=this;if(e.parent)e.physicsBody&&(this.removePhysicsBody(e),e.forceUpdate());else{if(e.isBodyInitRequired()){var i={name:e.uniqueId,config:[e.getParam("mass")||.001,e.getParam("friction"),e.getParam("restitution")],size:[],type:[],pos:[],posShape:[],rot:[],rotShape:[],move:0!==e.getParam("mass"),density:e.getParam("mass"),friction:e.getParam("friction"),restitution:e.getParam("restitution"),world:this.world},n=[e];(p=e.object).getChildMeshes&&p.getChildMeshes().forEach((function(e){e.physicsImpostor&&n.push(e.physicsImpostor)}));var c=function(e){return Math.max(e,o.a.Epsilon)},h=new r.b;n.forEach((function(n){if(n.object.rotationQuaternion){var o=n.object.rotationQuaternion;h=o.clone(),n.object.rotationQuaternion.set(0,0,0,1),n.object.computeWorldMatrix(!0);var r=o.toEulerAngles(),p=n.getObjectExtendSize();if(n===e){var u=e.getObjectCenter();e.object.getAbsolutePivotPoint().subtractToRef(u,t._tmpPositionVector),t._tmpPositionVector.divideInPlace(e.object.scaling),i.pos.push(u.x),i.pos.push(u.y),i.pos.push(u.z),i.posShape.push(0,0,0),i.rotShape.push(0,0,0)}else{var l=n.object.position.clone();i.posShape.push(l.x),i.posShape.push(l.y),i.posShape.push(l.z),i.rotShape.push(57.29577951308232*r.x),i.rotShape.push(57.29577951308232*r.y),i.rotShape.push(57.29577951308232*r.z)}switch(n.object.rotationQuaternion.copyFrom(h),n.type){case s.a.ParticleImpostor:a.a.Warn("No Particle support in OIMO.js. using SphereImpostor instead");case s.a.SphereImpostor:var f=p.x,d=p.y,g=p.z,y=Math.max(c(f),c(d),c(g))/2;i.type.push("sphere"),i.size.push(y),i.size.push(y),i.size.push(y);break;case s.a.CylinderImpostor:var _=c(p.x)/2,b=c(p.y);i.type.push("cylinder"),i.size.push(_),i.size.push(b),i.size.push(b);break;case s.a.PlaneImpostor:case s.a.BoxImpostor:default:_=c(p.x),b=c(p.y);var m=c(p.z);i.type.push("box"),i.size.push(_),i.size.push(b),i.size.push(m)}n.object.rotationQuaternion=o}})),e.physicsBody=this.world.add(i),e.physicsBody.resetQuaternion(h),e.physicsBody.updatePosition(0)}else this._tmpPositionVector.copyFromFloats(0,0,0);var p;e.setDeltaPosition(this._tmpPositionVector)}},e.prototype.removePhysicsBody=function(e){this.world.removeRigidBody(e.physicsBody)},e.prototype.generateJoint=function(e){var t=e.mainImpostor.physicsBody,i=e.connectedImpostor.physicsBody;if(t&&i){var s,o=e.joint.jointData,r=o.nativeParams||{},c={body1:t,body2:i,axe1:r.axe1||(o.mainAxis?o.mainAxis.asArray():null),axe2:r.axe2||(o.connectedAxis?o.connectedAxis.asArray():null),pos1:r.pos1||(o.mainPivot?o.mainPivot.asArray():null),pos2:r.pos2||(o.connectedPivot?o.connectedPivot.asArray():null),min:r.min,max:r.max,collision:r.collision||o.collision,spring:r.spring,world:this.world};switch(e.joint.type){case n.a.BallAndSocketJoint:s="jointBall";break;case n.a.SpringJoint:a.a.Warn("OIMO.js doesn't support Spring Constraint. Simulating using DistanceJoint instead");var h=o;c.min=h.length||c.min,c.max=Math.max(c.min,c.max);case n.a.DistanceJoint:s="jointDistance",c.max=o.maxDistance;break;case n.a.PrismaticJoint:s="jointPrisme";break;case n.a.SliderJoint:s="jointSlide";break;case n.a.WheelJoint:s="jointWheel";break;case n.a.HingeJoint:default:s="jointHinge"}c.type=s,e.joint.physicsJoint=this.world.add(c)}},e.prototype.removeJoint=function(e){try{this.world.removeJoint(e.joint.physicsJoint)}catch(e){a.a.Warn(e)}},e.prototype.isSupported=function(){return void 0!==this.BJSOIMO},e.prototype.setTransformationFromPhysicsBody=function(e){if(!e.physicsBody.sleeping){if(e.physicsBody.shapes.next){for(var t=e.physicsBody.shapes;t.next;)t=t.next;e.object.position.copyFrom(t.position)}else e.object.position.copyFrom(e.physicsBody.getPosition());e.object.rotationQuaternion&&e.object.rotationQuaternion.copyFrom(e.physicsBody.getQuaternion())}},e.prototype.setPhysicsBodyTransformation=function(e,t,i){var s=e.physicsBody;e.physicsBody.shapes.next||(s.position.copy(t),s.orientation.copy(i),s.syncShapes(),s.awake())},e.prototype.setLinearVelocity=function(e,t){e.physicsBody.linearVelocity.copy(t)},e.prototype.setAngularVelocity=function(e,t){e.physicsBody.angularVelocity.copy(t)},e.prototype.getLinearVelocity=function(e){var t=e.physicsBody.linearVelocity;return t?new r.e(t.x,t.y,t.z):null},e.prototype.getAngularVelocity=function(e){var t=e.physicsBody.angularVelocity;return t?new r.e(t.x,t.y,t.z):null},e.prototype.setBodyMass=function(e,t){var i=0===t;e.physicsBody.shapes.density=i?1:t,e.physicsBody.setupMass(i?2:1)},e.prototype.getBodyMass=function(e){return e.physicsBody.shapes.density},e.prototype.getBodyFriction=function(e){return e.physicsBody.shapes.friction},e.prototype.setBodyFriction=function(e,t){e.physicsBody.shapes.friction=t},e.prototype.getBodyRestitution=function(e){return e.physicsBody.shapes.restitution},e.prototype.setBodyRestitution=function(e,t){e.physicsBody.shapes.restitution=t},e.prototype.sleepBody=function(e){e.physicsBody.sleep()},e.prototype.wakeUpBody=function(e){e.physicsBody.awake()},e.prototype.updateDistanceJoint=function(e,t,i){e.physicsJoint.limitMotor.upperLimit=t,void 0!==i&&(e.physicsJoint.limitMotor.lowerLimit=i)},e.prototype.setMotor=function(e,t,i,s){void 0!==i?a.a.Warn("OimoJS plugin currently has unexpected behavior when using setMotor with force parameter"):i=1e6,t*=-1;var n=s?e.physicsJoint.rotationalLimitMotor2:e.physicsJoint.rotationalLimitMotor1||e.physicsJoint.rotationalLimitMotor||e.physicsJoint.limitMotor;n&&n.setMotor(t,i)},e.prototype.setLimit=function(e,t,i,s){var n=s?e.physicsJoint.rotationalLimitMotor2:e.physicsJoint.rotationalLimitMotor1||e.physicsJoint.rotationalLimitMotor||e.physicsJoint.limitMotor;n&&n.setLimit(t,void 0===i?-t:i)},e.prototype.syncMeshWithImpostor=function(e,t){var i=t.physicsBody;e.position.x=i.position.x,e.position.y=i.position.y,e.position.z=i.position.z,e.rotationQuaternion&&(e.rotationQuaternion.x=i.orientation.x,e.rotationQuaternion.y=i.orientation.y,e.rotationQuaternion.z=i.orientation.z,e.rotationQuaternion.w=i.orientation.s)},e.prototype.getRadius=function(e){return e.physicsBody.shapes.radius},e.prototype.getBoxSizeToRef=function(e,t){var i=e.physicsBody.shapes;t.x=2*i.halfWidth,t.y=2*i.halfHeight,t.z=2*i.halfDepth},e.prototype.dispose=function(){this.world.clear()},e.prototype.raycast=function(e,t){return a.a.Warn("raycast is not currently supported by the Oimo physics plugin"),this._raycastResult.reset(e,t),this._raycastResult},e}()},skBc:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return f}));var s,n=i("mrSG"),o=i("/SR9"),r=i("aCSs"),a=i("dypj"),c=i("OJ6t"),h=i("uyO6"),p=(i("fnt0"),function(e){function t(t,i,s,n,o,r,a,c,p){void 0===c&&(c=0),void 0===p&&(p=!1);var u=e.call(this,t,"circleOfConfusion",["cameraMinMaxZ","focusDistance","cocPrecalculation"],["depthSampler"],s,n,o,r,a,null,c,void 0,null,p)||this;return u.lensSize=50,u.fStop=1.4,u.focusDistance=2e3,u.focalLength=50,u._depthTexture=null,u._depthTexture=i,u.onApplyObservable.add((function(e){if(u._depthTexture){e.setTexture("depthSampler",u._depthTexture);var t=u.lensSize/u.fStop*u.focalLength/(u.focusDistance-u.focalLength);e.setFloat("focusDistance",u.focusDistance),e.setFloat("cocPrecalculation",t),e.setFloat2("cameraMinMaxZ",u._depthTexture.activeCamera.minZ,u._depthTexture.activeCamera.maxZ)}else h.a.Warn("No depth texture set on CircleOfConfusionPostProcess")})),u}return Object(n.c)(t,e),Object.defineProperty(t.prototype,"depthTexture",{set:function(e){this._depthTexture=e},enumerable:!0,configurable:!0}),t}(c.a)),u=function(e){function t(t,i,s,n,o,a,c,h,p,u,l,f,d){void 0===h&&(h=null),void 0===p&&(p=r.a.BILINEAR_SAMPLINGMODE),void 0===f&&(f=0),void 0===d&&(d=!1);var g=e.call(this,t,s,n,o,a,p=2,u,l,f=0,"#define DOF 1\r\n",d)||this;return g.direction=s,g.onApplyObservable.add((function(e){null!=h&&e.setTextureFromPostProcess("textureSampler",h),e.setTextureFromPostProcessOutput("circleOfConfusionSampler",c),i.activeCamera&&e.setFloat2("cameraMinMaxZ",i.activeCamera.minZ,i.activeCamera.maxZ)})),g}return Object(n.c)(t,e),t}(i("AGTA").a),l=(i("bQB8"),function(e){function t(t,i,s,n,o,r,a,c,h,p,u){void 0===p&&(p=0),void 0===u&&(u=!1);var l=e.call(this,t,"depthOfFieldMerge",[],["circleOfConfusionSampler","blurStep0","blurStep1","blurStep2"],o,r,a,c,h,null,p,void 0,null,!0)||this;return l.blurSteps=n,l.onApplyObservable.add((function(e){e.setTextureFromPostProcess("textureSampler",i),e.setTextureFromPostProcessOutput("circleOfConfusionSampler",s),n.forEach((function(t,i){e.setTextureFromPostProcessOutput("blurStep"+(n.length-i-1),t)}))})),u||l.updateEffect(),l}return Object(n.c)(t,e),t.prototype.updateEffect=function(t,i,s,n,o,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===s&&(s=null),t||(t="",t+="#define BLUR_LEVEL "+(this.blurSteps.length-1)+"\n"),e.prototype.updateEffect.call(this,t,i,s,n,o,r)},t}(c.a));!function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(s||(s={}));var f=function(e){function t(t,i,n,a,c){void 0===n&&(n=s.Low),void 0===a&&(a=0),void 0===c&&(c=!1);var h=e.call(this,t.getEngine(),"depth of field",(function(){return h._effects}),!0)||this;h._effects=[],h._circleOfConfusion=new p("circleOfConfusion",i,1,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,a,c),h._depthOfFieldBlurY=[],h._depthOfFieldBlurX=[];var f=1,d=15;switch(n){case s.High:f=3,d=51;break;case s.Medium:f=2,d=31;break;default:d=15,f=1}for(var g=d/Math.pow(2,f-1),y=1,_=0;_<f;_++){var b=new u("verticle blur",t,new o.d(0,1),g,y,null,h._circleOfConfusion,0==_?h._circleOfConfusion:null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,a,c);b.autoClear=!1,y=.75/Math.pow(2,_);var m=new u("horizontal blur",t,new o.d(1,0),g,y,null,h._circleOfConfusion,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,a,c);m.autoClear=!1,h._depthOfFieldBlurY.push(b),h._depthOfFieldBlurX.push(m)}h._effects=[h._circleOfConfusion];for(_=0;_<h._depthOfFieldBlurX.length;_++)h._effects.push(h._depthOfFieldBlurY[_]),h._effects.push(h._depthOfFieldBlurX[_]);return h._dofMerge=new l("dofMerge",h._circleOfConfusion,h._circleOfConfusion,h._depthOfFieldBlurX,y,null,r.a.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,a,c),h._dofMerge.autoClear=!1,h._effects.push(h._dofMerge),h}return Object(n.c)(t,e),Object.defineProperty(t.prototype,"focalLength",{get:function(){return this._circleOfConfusion.focalLength},set:function(e){this._circleOfConfusion.focalLength=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fStop",{get:function(){return this._circleOfConfusion.fStop},set:function(e){this._circleOfConfusion.fStop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusDistance",{get:function(){return this._circleOfConfusion.focusDistance},set:function(e){this._circleOfConfusion.focusDistance=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lensSize",{get:function(){return this._circleOfConfusion.lensSize},set:function(e){this._circleOfConfusion.lensSize=e},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"DepthOfFieldEffect"},Object.defineProperty(t.prototype,"depthTexture",{set:function(e){this._circleOfConfusion.depthTexture=e},enumerable:!0,configurable:!0}),t.prototype.disposeEffects=function(e){for(var t=0;t<this._effects.length;t++)this._effects[t].dispose(e)},t.prototype._updateEffects=function(){for(var e=0;e<this._effects.length;e++)this._effects[e].updateEffect()},t.prototype._isReady=function(){for(var e=0;e<this._effects.length;e++)if(!this._effects[e].isReady())return!1;return!0},t}(a.a)}}]);